{"version":3,"sources":["controller.js"],"names":["xsound","angular","module","config","$compileProvider","aHrefSanitizationWhitelist","factory","$location","host","protocol","value","oscillatorNumbers","number","param","forEach","oscillatorNumber","X","C","source","domain","updateParamEachOscillator","updateParamOfModule","updateParamOfSource","sources","split","matches","match","parseInt","title","width","height","modal","html","$","dialog","autoOpen","show","hide","draggable","resizable","zIndex","buttons","OK","this","remove","openDialog","options","file","error","message","readFile","dropArea","addEventListener","event","preventDefault","removeClass","addClass","Blob","name","scope","timeout","rate","progress","lengthComputable","total","Math","floor","loaded","readFileProgress","isModalProgressReadFile","$rootScope","mode","startTime","endTime","update","currentTime","type","stop","start","time","times","convertTime","milliseconds","minutes","slice","seconds","String","format","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","mastervolume","params","glide","oscillator","oscillator0","oscillator1","envelopegenerator","attack","decay","sustain","release","compressor","state","threshold","knee","ratio","distortion","curve","samples","drive","color","tone","wah","cutoff","depth","resonance","equalizer","bass","middle","treble","presence","filter","frequency","Q","gain","autopanner","tremolo","ringmodulator","phaser","stage","mix","feedback","chorus","flanger","delay","dry","wet","reverb","run","$window","IS_XSOUND","isActives","visualization","sprite","mml","patch","clone","free","resize","setup","audio","echoCancellation","video","stream","i","len","length","socialbutton","lang","button","locale","size","directive","updateParam","restrict","template","link","iElement","iAttrs","controller","iTransclude","min","max","step","range","animate","classSuffix","each","index","element","uiSpinner","parents","attr","pow","spinner","children","slider","parseFloat","change","ui","slide","spin","uiSlider","parent","$timeout","createTimeString","$watch","duration","newVal","currentTimeText","effector","Boolean","on","css","innerHeight","tooltip","tooltipClass","sortable","axis","cancel","cursor","opacity","select2","currentSoundSource","selectedSoundSource","isEnableOneshot","midiAccess","inputs","outputs","indexes","volumes","onmidimessage","data","noteNumber","velocity","targetIndex","volume","push","ready","toFrequencies","reset","isSoundStops","noteOn","indexOf","splice","noteOff","isActive","activeTrack","selectAPI","EASING","model","slideDown","slideUp","readFileByDragAndDrop","readFileProgressCallback","readFileErrorCallback","uploader","success","arrayBuffer","call","$parent","next","val","writeMML","paused","readyMML","CANCEL","$scope","BASE_URL","getCurrentPatches","userAgent","_isDown","_oneshots","_getBufferIndex","pianoIndex","_calculateGuitarRate","guitarIndex","_calculateElectricGuitarRate","_loadUI","isReady","resources","settings","Array","setting","buffer","loop","end","_createOneshotSettings","buffers","reverbs","rirs","rir","ajax","url","decode","get","audioBuffer","$apply","progressStyle","preset","textStatus","object","isSafari","navigator","toLowerCase","isEndOpeing","isStart","progressWrapperStyle","padding","headerStyle","top","isModalProgressDecodeAudio","isModalProgressSessionWait","oscillators","label","group","pianoKeyboards","keyboards","A-4","A-4h","B-4","C-3","C-3h","D-3","D-3h","E-3","F-3","F-3h","G-3","G-3h","A-3","A-3h","B-3","C-2","C-2h","D-2","D-2h","E-2","F-2","F-2h","G-2","G-2h","A-2","A-2h","B-2","C-1","C-1h","D-1","D-1h","E-1","F-1","F-1h","G-1","G-1h","A-1","A-1h","B-1","Ch","D","Dh","E","F","Fh","G","Gh","A","Ah","B","C1","C1h","D1","D1h","E1","F1","F1h","G1","G1h","A1","A1h","B1","C2","C2h","D2","D2h","E2","F2","F2h","G2","G2h","A2","A2h","B2","C3","C3h","D3","D3h","E3","F3","F3h","G3","G3h","A3","A3h","B3","C4","whites","blacks","startApplication","isEndOpening","startSound","currentTarget","hasClass","stopSound","stopPropagation","clearKeyboards","isSoundStop","toggleOscillatorState","toggleAnalyserState","toggleMMLState","togglePatchState","colorbox","open","inline","href","transition","speed","fadeOut","returnFocus","onOpen","$broadcast","onCleanup","changeWaveType","triggerFileUploader","prev","trigger","durationText","sampleRate","ended","controlAudio","toggle","createDateTimeString","tracks","objectURL","finename","controlRecord","STOP","START","createWAVE","create","Audio","setAttribute","play","downloadWAVE","filename","clearTrack","CLEAR","clear","$document","drawNodeCallback","api","channel","setRealTimeAnalyser","fftSize","minDecibels","maxDecibels","smoothingTimeConstant","getElementById","interval","shape","wave","font","family","style","weight","right","grad","offset","setAnalyser","toggleSpriteMode","drag","toggleAnalyserChannel","$http","$sce","_stopCallback","sequence","_endedCallback","_errorCallback","note","mmls","mml1","replace","mml2","dataURL","trustAsHtml","string","random","then","response","catch","typeMML","textContent","controlMML","isSequences","stopMML","downloadMML","trim","toTextFile","IS_TLS","HOST","PATH","_openCallback","_closeCallback","_stateCallback","_waitCallback","toggleSessionState","isConnected","_sessionSetups","tls","port","path","close","TIMEOUT","POST_ORIGIN","_defaultPatches","_loadPatch","patches","isPushState","isObject","setState","octave","fine","currentPatches","history","pushState","_ajaxErrorHandler","onpopstate","isAuth","isSignin","isSignup","isPatchList","isSavePath","isAccount","isDisabled","csrf","signups","username","password","signins","deleteAccounts","authedUsername","patchname","patchLists","dialogPatchDetailId","isShowDialogPatchDetail","toggleAction","$on","cancelClose","stopImmediatePropagation","action","isSavePatch","signin","method","withCredentials","_csrf","headers","Content-Type","transformRequest","fromJson","signup","signout","deleteAccount","typePatchname","savePatch","toJson","openPatchDetail","patchList","isString","position","my","at","LOAD","UPDATE","DELETE","CLOSE"],"mappings":"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","file":"controller.min.js","sourcesContent":["/**\n * controller.js\n * @fileoverview AngularJS controller for X Sound Application\n *\n * JavaScript Libraries :\n *     XSound.js (https://github.com/Korilakkuma/XSound)\n *     jQuery / jQuery UI\n *     select2.js\n *     jquery.socialbutton\n *\n * Copyright (c) 2012, 2013, 2014 Tomohiro IKEDA (Korilakkuma)\n * Released under the MIT license\n */\n \n \n \n(function() {\n    'use strict';\n\n    var xsound = angular.module('xsound', ['ngSanitize']);\n\n    /**\n     * This configuration for set Data URL and Object URL  (except \"unsafe:\").\n     * @param {$compileProvider} $compileProvider This argument is service of DI (Dependency Injection).\n     */\n    xsound.config(['$compileProvider', function($compileProvider) {\n        $compileProvider.aHrefSanitizationWhitelist(/^\\s*(https?|data|blob):/);\n    }]);\n\n    /**\n     * for loading resources (one-shot audios, RIRs, MML texts).\n     * @param {$location} $location This argument is service that wraps location object.\n     */\n    xsound.factory('BASE_URL', ['$location', function($location) {\n        var baseURL = '';\n\n        if ($location.host() === 'localhost') {\n            baseURL = $location.protocol() + '://' + $location.host() + '/~korilakkuma/GitHub/X-Sound/resources/';\n        } else {\n            baseURL = $location.protocol() + '://' + $location.host() + '/resources/';\n        }\n\n        return baseURL;\n    }]);\n\n    /**\n     * This is the sound sources that this application uses.\n     */\n    xsound.value('sources', ['mixer', 'oscillator', 'oneshot', 'audio', 'stream', 'noise']);\n\n    /**\n     * This is the array of number in order to identify oscillator.\n     */\n    xsound.value('oscillatorNumbers', [0, 1, 2, 3]);\n\n    /**\n     * This service sets parameter each oscillator.\n     * @param {Arrya.<number>} oscillatorNumbers This is the array of number in order to identify oscillator.\n     * @param {number} number This argument is either 0 or 1 in this application.\n     * @param {string} module This argument is module name this is defined by XSound.js.\n     * @param {string} param This argument is parameter name that is defined by XSound.js.\n     * @param {number|string} value This argument is parameter value.\n     */\n    xsound.value('updateParamEachOscillator', function(oscillatorNumbers, number, module, param, value) {\n        switch (number) {\n            case 0 :\n                if (module) {\n                    angular.forEach(oscillatorNumbers, function(oscillatorNumber) {\n                        X('oscillator', oscillatorNumber).module(module).param(param, value);\n                    });\n                } else {\n                    angular.forEach(oscillatorNumbers, function(oscillatorNumber) {\n                        X('oscillator', oscillatorNumber).param(param, value);\n                    });\n                }\n                break;\n            case 1 :\n                if (module)  {\n                    angular.forEach(oscillatorNumbers, function(oscillatorNumber) {\n                        C('oscillator', oscillatorNumber).module(module).param(param, value);\n                    });\n                } else {\n                    angular.forEach(oscillatorNumbers, function(oscillatorNumber) {\n                        C('oscillator', oscillatorNumber).param(param, value);\n                    });\n                }\n\n                break;\n            default :\n                break;\n        }\n    });\n\n    /**\n     * This service sets parameter for module.\n     * @param {string} source This argument is sound source name that is defined by XSound.js.\n     * @param {string} module This argument is module name this is defined by XSound.js.\n     * @param {string} param This argument is parameter name that is defined by XSound.js.\n     * @param {number|string} value This argument is parameter value.\n     */\n    xsound.value('updateParamOfModule', function(source, module, param, value) {\n        if ((source === 'oscillator') && (module === 'envelopegenerator')) {\n            X('oscillator').module('envelopegenerator').param(param, value);\n            C('oscillator').module('envelopegenerator').param(param, value);\n        } else if ((module === 'analyser') && (param === 'interval')) {\n            if (value > 0) {\n                X(source).module('analyser').domain('time').param('interval', value);\n                X(source).module('analyser').domain('fft').param('interval', value);\n            } else {\n                X(source).module('analyser').domain('time').param('interval', 'auto');\n                X(source).module('analyser').domain('fft').param('interval', 'auto');\n            }\n        } else {\n            X(source).module(module).param(param, value);\n\n            if (source === 'oscillator') {\n                C('oscillator').module(module).param(param, value);\n            }\n        }\n    });\n\n    /**\n     * This service sets parameter for sound source.\n     * @param {string} source This argument is sound source name that is defined by XSound.js.\n     * @param {string} param This argument is parameter name that is defined by XSound.js.\n     * @param {number|string} value This argument is parameter value.\n     */\n    xsound.value('updateParamOfSource', function(source, param, value) {\n        if ((source === 'oneshot') && (param === 'playbackRate')) {\n            X('oneshot').param('transpose', value);\n        } else {\n            X(source).param(param, value);\n            C('oscillator').param(param, value);\n        }\n    });\n\n    xsound.factory('updateParam', ['oscillatorNumbers', 'updateParamEachOscillator', 'updateParamOfModule', 'updateParamOfSource', function(oscillatorNumbers, updateParamEachOscillator, updateParamOfModule, updateParamOfSource) {\n        /*\n         * This service sets parameter.\n         * @param {string} source This argument is sound source name that is defined by XSound.js.\n         * @param {string} module This argument is module name this is defined by XSound.js.\n         * @param {string} param This argument is parameter name that is defined by XSound.js.\n         * @param {number|string} value This argument is parameter value.\n         */\n        return function(source, module, param, value) {\n            var sources = [];\n\n            if (source) {\n                sources = source.split(' ');\n            } else {\n                sources = ['mixer', 'oscillator', 'oneshot', 'audio', 'stream', 'noise'];\n            }\n\n            angular.forEach(sources, function(source) {\n                var matches = source.match(/oscillator(0|1)/);\n\n                if (matches !== null) {\n                    updateParamEachOscillator(oscillatorNumbers, parseInt(matches[1]), module, param, value);\n                } else {\n                    if (module) {\n                        updateParamOfModule(source, module, param, value);\n                    } else {\n                        updateParamOfSource(source, param, value);\n                    }\n                }\n            });\n        };\n    }]);\n\n    /**\n     * This service opens jQuery UI Dialog.\n     * @param {string} title This argument is dialog title.\n     * @param {number|string} width This argument is dialog width.\n     * @param {number|string} height This argument is dialog height.\n     * @param {boolean} modal This argument is to determine whether using modal window.\n     * @param {string} html This argument is dialog message.\n     */\n    xsound.value('openDialog', function(title, width, height, modal, html) {\n        $('<div />').html(html).dialog({\n            title     : title,\n            autoOpen  : true,\n            show      : 'explode',\n            hide      : 'explode',\n            width     : width,\n            height    : height,\n            modal     : modal,\n            draggable : true,\n            resizable : false,\n            zIndex    : 9999,\n            buttons   : {\n                'OK' : function() {\n                    $(this).dialog('close')\n                           .dialog('destroy')\n                           .remove();\n                }\n            }\n        });\n    });\n\n    xsound.factory('readFile', ['openDialog', function(openDialog) {\n        /**\n         * This service reads file.\n         * @param {object} options This argument is associative array that is defined by XSound.js.\n         */\n        return function(options) {\n            var file = null;\n\n            try {\n                file = X.file(options);\n            } catch (error) {\n                openDialog('Error', 500, 'auto', true, ('<p><b>' + error.message + '</b></p>'));\n            }\n\n            return file;\n        };\n    }]);\n\n    xsound.factory('readFileByDragAndDrop', ['readFile', function(readFile) {\n        /**\n         * This service reads file by Drag & Drop.\n         * @param {HTMLElement} dropArea This argument is the instance of HTMLElement for drop area.\n         * @param {object} options This argument is associative array that is defined by XSound.js.\n         */\n        return function(dropArea, options) {\n            dropArea.addEventListener('dragenter', function(event) {\n                event.preventDefault();\n\n                $(this).removeClass('drag-off').addClass('drag-on');\n            });\n\n            dropArea.addEventListener('dragover', function(event) {\n                event.preventDefault();\n            });\n\n            dropArea.addEventListener('dragleave', function(event) {\n                $(this).removeClass('drag-on').addClass('drag-off');\n            });\n\n            dropArea.addEventListener('drop', function(event) {\n                $(this).removeClass('drag-on').addClass('drag-off');\n\n                options.event = event;\n\n                var file = readFile(options);\n\n                if (file instanceof Blob) {\n                    this.value = file.name;\n                }\n            });\n        };\n    }]);\n\n    xsound.factory('readFileErrorCallback', ['openDialog', function(openDialog) {\n        /**\n         * This service is invoked when reading file failed.\n         * @param {string} error This arguemnt is error message.\n         */\n        return function(error) {\n            var message = '';\n\n            switch (error) {\n                case 'FILE_IS_NOT_BLOB' : message = 'The designated file is not Blob';            break;\n                case 'NOT_FOUND_ERR'    : message = 'There is not file';                          break;\n                case 'SECURITY_ERR'     : message = 'Security error occurred';                    break;\n                case 'ABORT_ERR'        : message = 'Abort';                                      break;\n                case 'NOT_READABLE_ERR' : message = 'The authority to read file does not exists'; break;\n                case 'ENCODING_ERR'     : message = 'FIle size exceeds limit';                    break;\n                case 'ERR'              : message = 'Error. Please try again.';                   break;\n            }\n\n            openDialog('Error', 500, 'auto', true, ('<p><b>' + message + '</b></p>'));\n        };\n    }]);\n\n    /**\n     * This service is invoked while file is read.\n     * @param {$scope} scope This argument is scope object of each controller.\n     * @param {$timeout} timeout This argument is in order to update view.\n     * @param {Event} event This argument is event object that the instance of FileReader creates.\n     */\n    xsound.value('readFileProgressCallback', function(scope, timeout, event) {\n        var rate     = 0;\n        var progress = '';\n\n        if (event.lengthComputable && (event.total > 0)) {\n            rate     = Math.floor((event.loaded / event.total) * 100);\n            progress = event.loaded + ' Bytes load (' + rate + ' %)';// +  event.total + ' Bytes';\n\n            timeout(function() {\n                scope.readFileProgress = progress;\n\n                if (!scope.isModalProgressReadFile) {\n                    scope.isModalProgressReadFile = true;\n                }\n            });\n        }\n    });\n\n    xsound.factory('drawNodeCallback', ['$rootScope', function($rootScope) {\n        /**\n         * This service redraws Canvas or SVG according to audio position.\n         * @param {$timeout} timeout This argument is in order to update view.\n         * @param {number} currentTime This argument is current time of audio.\n         */\n        return function(timeout, mode, event, startTime, endTime) {\n            if (mode === 'update') {\n                if ((startTime >= 0) && (startTime <= X('audio').param('duration'))) {\n                    X('audio').param('currentTime', startTime);\n                    X('audio').module('analyser').domain('time-overview-L').update(startTime);\n                    X('audio').module('analyser').domain('time-overview-R').update(startTime);\n\n                    timeout(function() {\n                        $rootScope.currentTime = startTime;\n                    });\n                }\n            } else if ((mode === 'sprite') && ((event.type === 'mouseup') || (event.type === 'touchend'))) {\n                X('audio').stop().start(startTime, endTime);\n            }\n        };\n    }]);\n\n    /**\n     * This service creates formatted time string.\n     * @param {number} time This argument is time (seconds).\n     */\n    xsound.value('createTimeString', function(time) {\n        var times = X.convertTime(time);\n\n        if (times.milliseconds === 0) {\n            return ('0' + times.minutes).slice(-2) + ' : ' + ('0' + times.seconds).slice(-2) + '.00';\n        } else {\n            return ('0' + times.minutes).slice(-2) + ' : ' + ('0' + times.seconds).slice(-2) + '.' + String(times.milliseconds).slice(2, 4);\n        }\n    });\n\n    /**\n     * This service creates string that represents datetime.\n     * The created string is used to filename.\n     */\n    xsound.value('createDateTimeString', function() {\n        var format = function(number) {\n            return ('0' + number).slice(-2);\n        };\n\n        var date = new Date();\n\n        var y = date.getFullYear();\n        var m = format(date.getMonth() + 1);\n        var d = format(date.getDate());\n        var h = format(date.getHours());\n        var i = format(date.getMinutes());\n        var s = format(date.getSeconds());\n\n        var datetime = y + m + d + h + i + s;\n\n        return datetime;\n    });\n\n    /**\n     * This service gets current parameters.\n     */\n    xsound.value('getCurrentPatches', function() {\n        return {\n            'mastervolume'      : X('oscillator').params().mastervolume,\n            'glide'             : {\n                'type' : X('oscillator').params().oscillator.glide.type,\n                'time' : X('oscillator').params().oscillator.glide.time\n            },\n            'oscillator0'       : X('oscillator').params().oscillator.oscillator0,\n            'oscillator1'       : C('oscillator').params().oscillator.oscillator0,\n            'envelopegenerator' : {\n                'attack'  : X('oscillator').params().envelopegenerator.attack,\n                'decay'   : X('oscillator').params().envelopegenerator.decay,\n                'sustain' : X('oscillator').params().envelopegenerator.sustain,\n                'release' : X('oscillator').params().envelopegenerator.release\n            },\n            'compressor'        : {\n                'state'     : X('oscillator').params().compressor.state,\n                'threshold' : X('oscillator').params().compressor.threshold,\n                'knee'      : X('oscillator').params().compressor.knee,\n                'ratio'     : X('oscillator').params().compressor.ratio,\n                'attack'    : X('oscillator').params().compressor.attack,\n                'release'   : X('oscillator').params().compressor.release\n            },\n            'distortion'        : {\n                'state'   : X('oscillator').params().distortion.state,\n                'curve'   : X('oscillator').params().distortion.curve,\n                'samples' : X('oscillator').params().distortion.samples,\n                'drive'   : X('oscillator').params().distortion.drive,\n                'color'   : X('oscillator').params().distortion.color,\n                'tone'    : X('oscillator').params().distortion.tone\n            },\n            'wah'               : {\n                'state'     : X('oscillator').params().wah.state,\n                'cutoff'    : X('oscillator').params().wah.cutoff,\n                'depth'     : X('oscillator').params().wah.depth,\n                'rate'      : X('oscillator').params().wah.rate,\n                'resonance' : X('oscillator').params().wah.resonance\n            },\n            'equalizer'         : {\n                'state'    : X('oscillator').params().equalizer.state,\n                'bass'     : X('oscillator').params().equalizer.bass,\n                'middle'   : X('oscillator').params().equalizer.middle,\n                'treble'   : X('oscillator').params().equalizer.treble,\n                'presence' : X('oscillator').params().equalizer.presence\n            },\n            'filter'            : {\n                'state'     : X('oscillator').params().filter.state,\n                'type'      : X('oscillator').params().filter.type,\n                'frequency' : X('oscillator').params().filter.frequency,\n                'Q'         : X('oscillator').params().filter.Q,\n                'gain'      : X('oscillator').params().filter.gain,\n                'attack'    : X('oscillator').params().filter.attack,\n                'decay'     : X('oscillator').params().filter.decay,\n                'sustain'   : X('oscillator').params().filter.sustain,\n                'release'   : X('oscillator').params().filter.release\n            },\n            'autopanner'        : {\n                'state' : X('oscillator').params().autopanner.state,\n                'depth' : X('oscillator').params().autopanner.depth,\n                'rate'  : X('oscillator').params().autopanner.rate\n            },\n            'tremolo'           : {\n                'state' : X('oscillator').params().tremolo.state,\n                'depth' : X('oscillator').params().tremolo.depth,\n                'rate'  : X('oscillator').params().tremolo.rate\n            },\n            'ringmodulator'     : {\n                'state' : X('oscillator').params().ringmodulator.state,\n                'depth' : X('oscillator').params().ringmodulator.depth,\n                'rate'  : X('oscillator').params().ringmodulator.rate\n            },\n            'phaser'            : {\n                'state'     : X('oscillator').params().phaser.state,\n                'stage'     : X('oscillator').params().phaser.stage,\n                'frequency' : X('oscillator').params().phaser.frequency,\n                'depth'     : X('oscillator').params().phaser.depth,\n                'rate'      : X('oscillator').params().phaser.rate,\n                'mix'       : X('oscillator').params().phaser.mix,\n                'feedback'  : X('oscillator').params().phaser.feedback\n            },\n            'chorus'            : {\n                'state' : X('oscillator').params().chorus.state,\n                'time'  : X('oscillator').params().chorus.time * 1000,\n                'depth' : X('oscillator').params().chorus.depth,\n                'rate'  : X('oscillator').params().chorus.rate,\n                'mix'   : X('oscillator').params().chorus.mix,\n                'tone'  : X('oscillator').params().chorus.tone\n            },\n            'flanger'           : {\n                'state'    : X('oscillator').params().flanger.state,\n                'time'     : X('oscillator').params().flanger.time * 1000,\n                'depth'    : X('oscillator').params().flanger.depth,\n                'rate'     : X('oscillator').params().flanger.rate,\n                'mix'      : X('oscillator').params().flanger.mix,\n                'tone'     : X('oscillator').params().flanger.tone,\n                'feedback' : X('oscillator').params().flanger.feedback\n            },\n            'delay'             : {\n                'state'    : X('oscillator').params().delay.state,\n                'time'     : X('oscillator').params().delay.time * 1000,\n                'dry'      : X('oscillator').params().delay.dry,\n                'wet'      : X('oscillator').params().delay.wet,\n                'tone'     : X('oscillator').params().delay.tone,\n                'feedback' : X('oscillator').params().delay.feedback\n            },\n            'reverb'            : {\n                'state'    : X('oscillator').params().reverb.state,\n                'dry'      : X('oscillator').params().reverb.dry,\n                'wet'      : X('oscillator').params().reverb.wet,\n                'tone'     : X('oscillator').params().reverb.tone\n            }\n        };\n    });\n\n    /**\n     * Initialization\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$window} $window This argument is service of DI (Dependency Injection).\n     * @param {Array.<string>} sources This argument is service of DI (Dependency Injection).\n     * @param {function} openDialog This argument is service of DI (Dependency Injection).\n     */\n    xsound.run(['$rootScope', '$window', 'sources' ,'openDialog', function($rootScope, $window, sources, openDialog) {\n        if (!X.IS_XSOUND) {\n            openDialog('Error', 600, 'auto', true, '<p><b>Your Browser does not support Web Audio API. Please use Chrome, Opera, Firefox (Mac / Windows) or Safari (Mac).</b></p>');\n            return;\n        }\n\n        $rootScope.isActives = {\n            visualization : false,\n            sprite        : false,\n            mml           : false,\n            patch         : false\n        };\n\n        // for Audio\n        $rootScope.currentTime = 0;\n\n        // Initialization for using XSound.js\n\n        // Clone X object as global object\n        $window.C = X.clone();  // for MML of OscillatorModule\n\n        // Not used\n        X.free([\n            X('media')\n        ]);\n\n        C.free([\n            C('oneshot'),\n            C('noise'),\n            C('audio'),\n            C('media'),\n            C('stream'),\n            C('mixer'),\n            C('midi')\n        ]);\n\n        // Resize buffer of ScriptProcessorNode\n        X('mixer').resize(1024);\n        X('oscillator').resize(1024);\n        C('oscillator').resize(1024);\n        X('oneshot').resize(1024);\n        X('audio').resize(8192);\n        X('stream').resize(512);\n\n        X('oscillator').setup([true, true, true, true]);\n        C('oscillator').setup([false, false, false, false]);\n\n        var constraints = {\n            audio : {\n                echoCancellation : false\n            },\n            video : false\n        };\n\n        X('stream').setup(constraints, function(stream) {\n        }, function(error) {\n            openDialog('Confirmation', 400, 'auto', true, '<p><b>Cancel Microphone.</b></p>');\n        });\n\n        angular.forEach(sources, function(source) {\n            X(source).module('distortion').param('color', 2000);\n            X(source).module('distortion').param('tone',  4000);\n            X(source).module('chorus').param('tone', 4000);\n            X(source).module('flanger').param('tone', 4000);\n            X(source).module('delay').param('tone', 4000);\n            X(source).module('reverb').param('tone', 4000);\n            X(source).module('filter').param('frequency', 8000);\n        });\n\n        C('oscillator').module('distortion').param('color', 2000);\n        C('oscillator').module('distortion').param('tone',  4000);\n        C('oscillator').module('chorus').param('tone', 4000);\n        C('oscillator').module('flanger').param('tone', 4000);\n        C('oscillator').module('delay').param('tone', 4000);\n        C('oscillator').module('reverb').param('tone', 4000);\n        C('oscillator').module('filter').param('frequency', 8000);\n\n        for (var i = 0, len = X('oscillator').length(); i < len; i++) {\n            X('oscillator', i).param('type', 'sawtooth');\n            C('oscillator', i).param('type', 'sawtooth');\n        }\n\n        $('#twitter').socialbutton('twitter', {lang : 'en_US'});\n        $('#facebook').socialbutton('facebook_like', {button : 'button_count', locale : 'en_US'});\n        $('#hatena').socialbutton('hatena');\n        $('#google').socialbutton('google_plusone', {size : 'medium'}).width(72);\n    }]);\n\n    /**\n     * Directive for wrapping jQuery UI Slider.\n     * @param {function} updateParam This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('uiSlider', ['updateParam', function(updateParam) {\n        return {\n            restrict : 'E',\n            template : '<div></div>',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var value   = iAttrs.value;\n                var min     = iAttrs.min;\n                var max     = iAttrs.max;\n                var step    = iAttrs.step;\n                var range   = iAttrs.range   || 'min';\n                var animate = iAttrs.animate || 'slow';\n                var source  = iAttrs.source;\n                var module  = iAttrs.module;\n                var param   = iAttrs.param;\n\n                var classSuffix = module ? (module + '-' + param) : param;\n\n                var update = function(value) {\n                    updateParam(source, module, param, value);\n\n                    $('.spinner-' + classSuffix).each(function(index, element) {\n                        var uiSpinner = $(element).parents('ui-spinner');\n\n                        if ((uiSpinner.attr('source') === source) && (uiSpinner.attr('module') === module)) {\n                            if ((module !== 'glide') && (param === 'time')) {\n                                value *= Math.pow(10, 3);  // sec -> msec\n                            }\n\n                            $(element).spinner('value', value);\n                        }\n                    });\n                };\n\n                $(iElement).children('div').addClass('slider-' + classSuffix).slider({\n                    value   : parseFloat(value),\n                    min     : parseFloat(min),\n                    max     : parseFloat(max),\n                    step    : parseFloat(step),\n                    range   : range,\n                    animate : animate,\n                    change  : function(event, ui) {\n                        // Triggered when the value is changed\n\n                        var value = parseFloat(ui.value);\n\n                        if ((module !== 'glide') && (param === 'time')) {\n                            value /= Math.pow(10, 3);  // msec -> sec\n                        }\n\n                        update(value);\n                    },\n                    slide   : function(event, ui) {\n                        var value = parseFloat(ui.value);\n\n                        if ((module !== 'glide') && (param === 'time')) {\n                            value /= Math.pow(10, 3);  //msec -> sec\n                        }\n\n                        update(value);\n                    }\n                });\n            }\n        };\n    }]);\n\n    /*\n     * Directive for wrapping jQuery UI Spinner.\n     * @param {function} updateParam This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('uiSpinner', ['updateParam', function(updateParam) {\n        return {\n            restrict : 'E',\n            template : '<input />',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var value   = iAttrs.value;\n                var min     = iAttrs.min;\n                var max     = iAttrs.max;\n                var step    = iAttrs.step;\n                var source  = iAttrs.source;\n                var module  = iAttrs.module;\n                var param   = iAttrs.param;\n\n                var classSuffix = module ? (module + '-' + param) : param;\n\n                var update = function(value) {\n                    updateParam(source, module, param, value);\n\n                    $('.slider-' + classSuffix).each(function(index, element) {\n                        var uiSlider = $(element).parent('ui-slider');\n\n                        if ((uiSlider.attr('source') === source) && (uiSlider.attr('module') === module)) {\n                            if ((module !== 'glide') && (param === 'time')) {\n                                value *= Math.pow(10, 3);  // sec -> msec\n                            }\n\n                            $(element).slider('value', value);\n                        }\n                    });\n                };\n\n                $(iElement).children('input').addClass('spinner-' + classSuffix).spinner({\n                    min  : parseFloat(min),\n                    max  : parseFloat(max),\n                    step : parseFloat(step),\n                    spin : function(event, ui) {\n                        var value = parseFloat(ui.value);\n\n                        if ((module !== 'glide') && (param === 'time')) {\n                            value /= Math.pow(10, 3);  // msec -> sec\n                        }\n\n                        update(value);\n                    }\n                }).spinner('value', parseFloat(value));\n            }\n        };\n    }]);\n\n    /**\n     * Directive for current time of audio (Slider).\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is in order to update view.\n     * @param {function} createTimeString This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('uiSliderTime', ['$rootScope', '$timeout', 'createTimeString', function($rootScope, $timeout, createTimeString) {\n        return {\n            restrict : 'E',\n            template : '<div></div>',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var value   = iAttrs.value;\n                var max     = iAttrs.max;\n                var step    = iAttrs.step;\n                var range   = iAttrs.range   || 'min';\n                var animate = iAttrs.animate || 'slow';\n\n                $(iElement).children('div').attr('id', 'slider-audio-current-time').slider({\n                    value   : parseFloat(value),\n                    min     : 0,\n                    max     : parseFloat(max),\n                    step    : parseFloat(step),\n                    range   : range,\n                    animate : animate,\n                    change  : function(event, ui) {\n                        //X('audio').param('currentTime', parseFloat(ui.value));\n                    },\n                    slide   : function(event, ui) {\n                        X('audio').param('currentTime', parseFloat(ui.value));\n                        X('audio').module('analyser').domain('time-overview-L').update(X('audio').param('currentTime'));\n                        X('audio').module('analyser').domain('time-overview-R').update(X('audio').param('currentTime'));\n\n                        $timeout(function() {\n                            $rootScope.currentTime = X('audio').param('currentTime');\n                        });\n                    }\n                });\n\n                scope.$watch(function() {\n                    return scope.duration;\n                }, function(newVal) {\n                    $('#slider-audio-current-time').slider('option', 'max', newVal);\n                    $('#spinner-audio-current-time').spinner('option', 'max', newVal);\n                });\n\n                var setCurrentTime = function(currentTime) {\n                    $('#slider-audio-current-time').slider('value', currentTime);\n                    $('#spinner-audio-current-time').spinner('value', currentTime);\n\n                    scope.currentTimeText = createTimeString(currentTime);\n                };\n\n                scope.$watch(function() {\n                    return $rootScope.currentTime;\n                }, function(newVal) {\n                    setCurrentTime(newVal);\n                });\n            }\n        };\n    }]);\n\n   /**\n     * Directive for current time of audio (Spinner).\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is in order to update view.\n     */\n    xsound.directive('uiSpinnerTime', ['$rootScope', '$timeout', function($rootScope, $timeout) {\n        return {\n            restrict : 'E',\n            template : '<input />',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var value   = iAttrs.value;\n                var max     = iAttrs.max;\n                var step    = iAttrs.step;\n\n                $(iElement).children('input').attr('id', 'spinner-audio-current-time').spinner({\n                    min  : 0,\n                    max  : parseFloat(max),\n                    step : parseFloat(step),\n                    spin : function(event, ui) {\n                        X('audio').param('currentTime', parseFloat(ui.value));\n                        X('audio').module('analyser').domain('time-overview-L').update(X('audio').param('currentTime'));\n                        X('audio').module('analyser').domain('time-overview-R').update(X('audio').param('currentTime'));\n\n                        $timeout(function() {\n                            $rootScope.currentTime = X('audio').param('currentTime');\n                        });\n                    }\n                }).spinner('value', parseFloat(value));\n            }\n        };\n    }]);\n\n    /*\n     * Directive for toggle effector state.\n     * @param {Array.<string>} sources This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('uiToggleEffector', ['sources', function(sources) {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var effector = iAttrs.effector;\n                var state    = parseInt(iAttrs.state);\n\n                // Set initial state\n                if ((state === 0) || (state === 1)) {\n                    angular.forEach(sources, function(source) {\n                        X(source).module(effector).state(Boolean(state));\n                        C('oscillator').module(effector).state(Boolean(state));\n\n                        if (X(source).module(effector).state()) {\n                            $(iElement).addClass('check-on');\n                        } else {\n                            $(iElement).removeClass('check-on');\n                        }\n                    });\n                }\n\n                $(iElement).on('click', function() {\n                    angular.forEach(sources, function(source) {\n                        if (X(source).module(effector).state()) {\n                            X(source).module(effector).state(false);\n                            C('oscillator').module(effector).state(false);\n\n                            $(iElement).removeClass('check-on');\n                        } else {\n                            X(source).module(effector).state(true);\n                            C('oscillator').module(effector).state(true);\n\n                            $(iElement).addClass('check-on');\n                        }\n                    });\n                });\n            }\n        };\n    }]);\n\n    /**\n     * Directive for progress.\n     * @param {$window} $window This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('uiModalProgress', ['$window', function($window) {\n        return {\n            restrict : 'E',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                $(iElement).children('section').css('margin-top', ((($window.innerHeight / 2) - 80) + 'px'));\n            }\n        };\n    }]);\n\n    /**\n     * Directive for wrapping jQuery UI Tooltip.\n     */\n    xsound.directive('uiTooltip', function() {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                // jQuery UI tooltip\n                $(iElement).tooltip({\n                    tooltipClass : 'ui-tooltip-custom'\n                });\n            }\n        };\n    });\n\n    /**\n     * Directive for wrapping jQuery UI Sortable.\n     */\n    xsound.directive('uiSortable', function() {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                $(iElement).sortable({\n                    axis        : 'x',\n                    cancel      : 'fieldset, :input, button, label, a, #piano',\n                    // containment : 'parent',\n                    cursor      : 'move',\n                    opacity     : 0.6\n                    // revert      : true\n                });\n            }\n        };\n    });\n\n    /**\n     * Directive for wrapping select2.js.\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {Array.<string>} sources This argument is service of DI (Dependency Injection).\n     * @param {function} openDialog This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('uiSelect', ['$timeout', 'sources', 'openDialog', function($timeout, sources, openDialog) {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                // Initialization\n                $(iElement).select2();\n\n                switch ($(iElement).attr('id')) {\n                    case 'select-sound-source' :\n                        $(iElement).on('change', function() {\n                            var value = this.value;\n\n                            switch (value) {\n                                case 'oscillator' :\n                                    X('stream').stop();\n\n                                    $timeout(function() {\n                                        // This is scope of XSoundController\n                                        scope.currentSoundSource  = value;\n                                        scope.selectedSoundSource = value;\n                                    });\n\n                                    break;\n                                case 'piano'          :\n                                case 'guitar'         :\n                                case 'electric-guitar':\n                                    if (scope.isEnableOneshot) {\n                                        $timeout(function() {\n                                            // This is scope of XSoundController\n                                            scope.currentSoundSource = value;\n                                            scope.selectedSoundSource = value;\n                                        });\n                                    }\n\n                                    X('stream').stop();\n\n                                    break;\n                                case 'whitenoise'   :\n                                case 'pinknoise'    :\n                                case 'browniannoise':\n                                    X('stream').stop();\n\n                                    $timeout(function() {\n                                        // This is scope of XSoundController\n                                        scope.currentSoundSource  = value;\n                                        scope.selectedSoundSource = value;\n                                    });\n\n                                    break;\n                                case 'stream' :\n                                    try {\n                                        X('stream').start();\n                                        X('stream').module('session').start();\n\n                                        $timeout(function() {\n                                            // This is scope of XSoundController\n                                            scope.selectedSoundSource = value;\n                                        });\n                                    } catch (error) {\n                                        openDialog('Error', 400, 'auto', true, ('<p><b>' + error.message + '</b></p>'));\n                                    }\n\n                                    break;\n                                case 'midi' :\n                                    X('stream').stop();\n\n                                    var successCallback = function(midiAccess, inputs, outputs) {\n                                        var MIN_NOTE_NUMBER = 21;\n                                        var MAX_NOTE_NUMBER = 108;\n                                        var MAX_VELOCITY    = 127;\n\n                                        var indexes = [];\n                                        var volumes = [];\n\n                                        var noteOn = function(noteNumber, velocity) {\n                                            if ((noteNumber < MIN_NOTE_NUMBER) || (noteNumber > MAX_NOTE_NUMBER)) {\n                                                return;\n                                            }\n\n                                            if ((velocity < 0) || (velocity > MAX_VELOCITY)) {\n                                                return;\n                                            }\n\n                                            var targetIndex = noteNumber - MIN_NOTE_NUMBER;\n                                            var volume      = velocity / MAX_VELOCITY;\n\n                                            if (scope.currentSoundSource === 'oscillator') {\n                                                indexes.push(targetIndex);\n\n                                                volumes[0] = X('oscillator', 0).param('volume');\n                                                volumes[1] = C('oscillator', 0).param('volume');\n\n                                                for (var i = 0, len = X('oscillator').length(); i < len; i++) {\n                                                    if (i !== 0) {\n                                                        X('oscillator', i).state(true);\n                                                        C('oscillator', i).state(true);\n                                                    }\n\n                                                    X('oscillator', i).param('volume', volume);\n                                                    C('oscillator', i).param('volume', volume);\n                                                }\n\n                                                X('oscillator').ready(0, 0).start(X.toFrequencies(indexes));\n                                                C('oscillator').ready(0, 0).start(X.toFrequencies(indexes));\n\n                                                X('mixer').mix([X('oscillator'), C('oscillator')]);\n\n                                                X('mixer').module('recorder').start();\n                                                X('mixer').module('session').start();\n                                            } else {\n                                                X('oneshot').reset(targetIndex, 'volume', volume).ready(0, 0).start(targetIndex);\n\n                                                X('oneshot').module('recorder').start();\n                                                X('oneshot').module('session').start();\n                                            }\n\n                                            $timeout(function() {\n                                                scope.isSoundStops[targetIndex] = false;\n                                            });\n                                        };\n\n                                        var noteOff = function(noteNumber, velocity) {\n                                            if ((noteNumber < MIN_NOTE_NUMBER) || (noteNumber > MAX_NOTE_NUMBER)) {\n                                                return;\n                                            }\n\n                                            if ((velocity < 0) || (velocity > MAX_VELOCITY)) {\n                                                return;\n                                            }\n\n                                            var targetIndex = noteNumber - MIN_NOTE_NUMBER;\n\n                                            if (scope.currentSoundSource === 'oscillator') {\n                                                var index = indexes.indexOf(targetIndex);\n\n                                                if (index !== -1) {\n                                                    indexes.splice(index, 1);\n                                                }\n\n                                                X('oscillator').stop();\n                                                C('oscillator').stop();\n\n                                                for (var i = 0, len = X('oscillator').length(); i < len; i++) {\n                                                    if (i !== 0) {\n                                                        X('oscillator', i).state(false);\n                                                        C('oscillator', i).state(false);\n                                                    }\n\n                                                    X('oscillator', i).param('volume', volumes[0]);\n                                                    C('oscillator', i).param('volume', volumes[1]);\n                                                }\n                                            } else {\n                                                X('oneshot').stop(targetIndex).reset(targetIndex, 'volume', 1);\n                                            }\n\n                                            $timeout(function() {\n                                                scope.isSoundStops[targetIndex] = true;\n                                            });\n                                        };\n\n                                        if (inputs.length > 0) {\n                                            inputs[0].onmidimessage = function(event) {\n                                                switch (event.data[0] & 0xf0) {\n                                                    case 0x90 :\n                                                        noteOn(event.data[1], event.data[2]);\n                                                        break;\n                                                    case 0x80 :\n                                                        noteOff(event.data[1], event.data[2]);\n                                                        break;\n                                                    default :\n                                                        break;\n                                                }\n                                            };\n                                        }\n                                    };\n\n                                    var errorCallback = function(error) {\n                                        openDialog('Error', 400, 'auto', true, '<p><b>Cannot use Web MIDI API.</b></p>');\n                                    };\n\n                                    try {\n                                        X('midi').setup(true, successCallback, errorCallback);\n                                    } catch (error) {\n                                        openDialog('Error', 400, 'auto', true, ('<p><b>' + error.message + '</b></p>'));\n                                    }\n\n                                    break;\n                                default :\n                                    break;\n                            }\n                        });\n\n                        break;\n                    case 'select-rec-track' :\n                        $(iElement).on('change', function() {\n                            if (scope.isActive) {\n                                // In the case of recording\n                                return;\n                            }\n\n                            var value = parseInt(this.value);\n\n                            $timeout(function() {\n                                // This is scope of RecordController\n                                scope.activeTrack = value;\n                            });\n\n                            angular.forEach(sources, function(source) {\n                                if (source !== 'oscillator') {\n                                    X(source).module('recorder').ready(value);\n\n                                    if (source === 'stream') {\n                                        X('stream').module('recorder').start();\n                                    }\n                                }\n                            });\n                        });\n\n                        break;\n                    case 'select-visualization-api' :\n                        $(iElement).on('change', function() {\n                            // This is scope of VisualizationController\n                            scope.selectAPI(this.value);\n                        });\n\n                        break;\n                    case 'select-distortion-type' :\n                        $(iElement).on('change', function() {\n                            var value = this.value;\n\n                            angular.forEach(sources, function(source) {\n                                X(source).module('distortion').param('curve', value);\n                            });\n                        });\n\n                        break;\n                    case 'select-distortion-sample' :\n                        $(iElement).on('change', function() {\n                            var value = this.value;\n\n                            angular.forEach(sources, function(source) {\n                                X(source).module('distortion').param('samples', value);\n                            });\n                        });\n\n                        break;\n                    case 'select-filter-type' :\n                        $(iElement).on('change', function() {\n                            var value = this.value;\n\n                            angular.forEach(sources, function(source) {\n                                X(source).module('filter').param('type', value);\n                            });\n                        });\n\n                        break;\n                    case 'select-phaser-stage' :\n                        $(iElement).on('change', function() {\n                            var value = this.value;\n\n                            angular.forEach(sources, function(source) {\n                                X(source).module('phaser').param('stage', value);\n                            });\n                        });\n\n                        break;\n                    case 'select-reverb-type' :\n                        $(iElement).on('change', function() {\n                            var value = parseInt(this.value) - 1;\n\n                            if (value === -1) {\n                                value = null;\n                            }\n\n                            angular.forEach(sources, function(source) {\n                                X(source).module('reverb').param('type', value);\n                            });\n                        });\n\n                        break;\n                    default :\n                        break;\n                }\n            }\n        };\n    }]);\n\n    /**\n     * Directive for slide block.\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('slideBlock', ['$rootScope', function($rootScope) {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var DURATION = 1000;\n                var EASING   = 'easeOutQuint';\n\n                var model = iAttrs.model;\n\n                $(iElement).hide();\n\n                scope.$watch(function() {\n                    return $rootScope.isActives;\n                }, function(newVal) {\n                    if (newVal[model]) {\n                        $(iElement).slideDown(DURATION, EASING);\n                    } else {\n                        $(iElement).slideUp(DURATION, EASING);\n                    }\n                }, true);\n            }\n        };\n    }]);\n\n    /**\n     * Directive for upload audio file.\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {function} readFile This argument is service of DI (Dependency Injection).\n     * @param {function} readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {function} readFileProgressCallback This argument is service of DI (Dependency Injection).\n     * @param {function} readFileErrorCallback This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('audioUploader', ['$timeout', 'readFile', 'readFileByDragAndDrop', 'readFileProgressCallback', 'readFileErrorCallback', function($timeout, readFile, readFileByDragAndDrop, readFileProgressCallback, readFileErrorCallback) {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var uploader = iElement[0];\n\n                var options = {\n                    event   : null,\n                    type    : 'ArrayBuffer',\n                    success : function(event, arrayBuffer) {\n                        X('audio').ready.call(X('audio'), arrayBuffer);\n\n                        $timeout(function() {\n                            scope.$parent.isModalProgressReadFile = false;\n                        });\n                    },\n                    error   : function(event, error) {\n                        readFileErrorCallback(error);\n                    },\n                    progress : function(event) {\n                        readFileProgressCallback(scope.$parent, $timeout, event);\n                    }\n                };\n\n                // <input type=\"file\">\n                uploader.addEventListener('change', function(event) {\n                    options.event = event;\n\n                    var file = readFile(options);\n\n                    this.value = '';  //Clear\n\n                    if (file instanceof Blob) {\n                        $(iElement).next('[type=\"text\"]').val(file.name);\n                    }\n                }, false);\n\n                // Drag & Drop\n                var dropArea = $(iElement).next('[type=\"text\"]')[0];\n\n                readFileByDragAndDrop(dropArea, options);\n            }\n        };\n    }]);\n\n    /**\n     * Directive for upload RIR file.\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {Array.<string>} sources This argument is service of DI (Dependency Injection).\n     * @param {function} readFile This argument is service of DI (Dependency Injection).\n     * @param {function} readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {function} readFileProgressCallback This argument is service of DI (Dependency Injection).\n     * @param {function} readFileErrorCallback This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('rirUploader', ['$timeout', 'sources', 'readFile', 'readFileByDragAndDrop', 'readFileProgressCallback', 'readFileErrorCallback', function($timeout, sources, readFile, readFileByDragAndDrop, readFileProgressCallback, readFileErrorCallback) {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var uploader = iElement[0];\n\n                var options = {\n                    event   : null,\n                    type    : 'ArrayBuffer',\n                    success : function(event, arrayBuffer) {\n                        angular.forEach(sources, function(source) {\n                            X(source).module('reverb').start.call(X(source).module('reverb'), arrayBuffer);\n                        });\n\n                        $timeout(function() {\n                            scope.isModalProgressReadFile = false;\n                        });\n                    },\n                    error   : function(event, error) {\n                        readFileErrorCallback(error);\n                    },\n                    progress : function(event) {\n                        readFileProgressCallback(scope, $timeout, event);\n                    }\n                };\n\n                // <input type=\"file\">\n                uploader.addEventListener('change', function(event) {\n                    options.event = event;\n\n                    var file = readFile(options);\n\n                    this.value = '';  //Clear\n\n                    if (file instanceof Blob) {\n                        $(iElement).next('[type=\"text\"]').val(file.name);\n                    }\n                }, false);\n\n                // Drag & Drop\n                var dropArea = $(iElement).next('[type=\"text\"]')[0];\n\n                readFileByDragAndDrop(dropArea, options);\n            }\n        };\n    }]);\n\n    /**\n     * Directive for upload MML text file.\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {function} readFile This argument is service of DI (Dependency Injection).\n     * @param {function} readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {function} readFileProgressCallback This argument is service of DI (Dependency Injection).\n     * @param {function} readFileErrorCallback This argument is service of DI (Dependency Injection).\n     */\n    xsound.directive('mmlUploader', ['$timeout', 'readFile', 'readFileByDragAndDrop', 'readFileProgressCallback', 'readFileErrorCallback', function($timeout, readFile, readFileByDragAndDrop, readFileProgressCallback, readFileErrorCallback) {\n        return {\n            restrict : 'A',\n            link     : function(scope, iElement, iAttrs, controller, iTransclude) {\n                var uploader = iElement[0];\n\n                var options = {\n                    event   : null,\n                    type    : 'Text',\n                    success : function(event, mml) {\n                        var writeMML = function() {\n                            $timeout(function() {\n                                scope.mml    = mml;\n                                scope.paused = true;\n\n                                scope.readyMML();\n                            });\n                        };\n\n                        if (scope.mml === '') {\n                            writeMML();\n                        } else {\n                            // Overwrite ?\n                            $('<div />').html('<p><b>MML already exists. Overwrite ?</b></p>').dialog({\n                                title     : 'Confirmation',\n                                autoOpen  : true,\n                                show      : 'explode',\n                                hide      : 'explode',\n                                modal     : true,\n                                width     : 500,\n                                height    : 'auto',\n                                draggable : true,\n                                resizable : false,\n                                zIndex    : 9999,\n                                buttons   : {\n                                    'OK'    : function() {\n                                        // Overwrite\n                                        writeMML();\n\n                                        $(this).dialog('close')\n                                               .dialog('destroy')\n                                               .remove();\n                                    },\n                                    'CANCEL' : function() {\n                                        $(this).dialog('close')\n                                               .dialog('destroy')\n                                               .remove();\n                                    }\n                                }\n                            });\n                        }\n\n                        $timeout(function() {\n                            scope.$parent.isModalProgressReadFile = false;\n                        });\n                    },\n                    error   : function(event, error) {\n                        readFileErrorCallback(error);\n                    },\n                    progress : function(event) {\n                        readFileProgressCallback(scope.$parent, $timeout, event);\n                    }\n                };\n\n                // <input type=\"file\">\n                uploader.addEventListener('change', function(event) {\n                    options.event = event;\n\n                    var file = readFile(options);\n\n                    this.value = '';  //Clear\n\n                    if (file instanceof Blob) {\n                        $(iElement).next('[type=\"text\"]').val(file.name);\n                    }\n                }, false);\n\n                // Drag & Drop\n                var dropArea = $(iElement).next('[type=\"text\"]')[0];\n\n                readFileByDragAndDrop(dropArea, options);\n            }\n        };\n    }]);\n\n    /**\n     * This controller is super class in X Sound Application\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$window} $window This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {string} BASE_URL This argument is service of DI (Dependency Injection).\n     * @param {Array.<string>} sources readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {Arrya.<number>} oscillatorNumbers This is the array of number in order to identify oscillator.\n     * @param {function} openDialog This argument is service of DI (Dependency Injection).\n     * @param {function} getCurrentPatches This argument is service of DI (Dependency Injection).\n     */\n    xsound.controller('XSoundController', ['$rootScope', '$scope', '$window', '$timeout', 'BASE_URL', 'sources', 'oscillatorNumbers', 'openDialog', 'getCurrentPatches', function($rootScope, $scope, $window, $timeout, BASE_URL, sources, oscillatorNumbers, openDialog, getCurrentPatches) {\n        var NUMBER_OF_ONESHOTS = 88;\n        var AJAX_TIMEOUT       = 60000;\n\n        var _isDown = false;\n\n        var _oneshots = [\n            (BASE_URL + 'one-shot/piano-2/C.wav'),\n            (BASE_URL + 'one-shot/piano-2/D.wav'),\n            (BASE_URL + 'one-shot/piano-2/E.wav'),\n            (BASE_URL + 'one-shot/piano-2/F.wav'),\n            (BASE_URL + 'one-shot/piano-2/G.wav'),\n            (BASE_URL + 'one-shot/piano-2/A.wav'),\n            (BASE_URL + 'one-shot/piano-2/B.wav'),\n            (BASE_URL + 'one-shot/guitar/C.mp3'),\n            (BASE_URL + 'one-shot/e-guitar/C.mp3')\n        ];\n\n        var _getBufferIndex = function(pianoIndex) {\n            switch (parseInt((pianoIndex + 9) % 12)) {\n                case  0 :\n                case  1 :\n                    return 0;\n                case  2 :\n                case  3 :\n                    return 1;\n                case  4 :\n                    return 2;\n                case  5 :\n                case  6 :\n                    return 3;\n                case  7 :\n                case  8 :\n                    return 4;\n                case  9 :\n                case 10 :\n                    return 5;\n                case 11 :\n                    return 6;\n                default :\n                    break;\n            }\n        };\n\n        var _calculatePianoRate = function(pianoIndex) {\n            var sharps  = [1, 4, 6, 9, 11, 13, 16, 18, 21, 23, 25, 28, 30, 33, 35, 37, 40, 42, 45, 47, 49, 52, 54, 57, 59, 61, 64, 66, 69, 71, 73, 76, 78, 81, 83, 85];\n            var isSharp = (sharps.indexOf(pianoIndex) !== -1) ? true : false;\n\n            var rate = 0;\n\n            if ((pianoIndex >= 0) && (pianoIndex <= 2)) {\n                rate = 0.0625;\n            } else if ((pianoIndex >= 3) && (pianoIndex <= 14)) {\n                rate = 0.125;\n            } else if ((pianoIndex >= 15) && (pianoIndex <= 26)) {\n                rate = 0.25;\n            } else if ((pianoIndex >= 27) && (pianoIndex <= 38)) {\n                rate = 0.5;\n            } else if ((pianoIndex >= 39) && (pianoIndex <= 50)) {\n                rate = 1;\n            } else if ((pianoIndex >= 51) && (pianoIndex <= 62)) {\n                rate = 2;\n            } else if ((pianoIndex >= 63) && (pianoIndex <= 74)) {\n                rate = 4;\n            } else if ((pianoIndex >= 75) && (pianoIndex <= 86)) {\n                rate = 8;\n            } else if ((pianoIndex >= 87) && (pianoIndex <= 98)) {\n                rate = 16;\n            }\n\n            if (isSharp) {\n                rate *= Math.pow(2, (1 / 12));\n            }\n\n            return rate;\n        };\n\n        var _calculateGuitarRate = function(guitarIndex) {\n            var rate = 0;\n\n            switch (guitarIndex - NUMBER_OF_ONESHOTS) {\n                case 0:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -39);\n                  break;\n                case 1:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -38);\n                  break;\n                case 2:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -37);\n                  break;\n                case 3:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -36);\n                  break;\n                case 4:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -35);\n                  break;\n                case 5:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -34);\n                  break;\n                case 6:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -33);\n                  break;\n                case 7:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -32);\n                  break;\n                case 8:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -31);\n                  break;\n                case 9:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -30)\n                  break;\n                case 10:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -29);\n                  break;\n                case 11:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -28);\n                  break;\n                case 12:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -27);\n                  break;\n                case 13:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -26);\n                  break;\n                case 14:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -25);\n                  break;\n                case 15:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -24);\n                  break;\n                case 16:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -23);\n                  break;\n                case 17:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -22);\n                  break;\n                case 18:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -21);\n                  break;\n                case 19:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -20);\n                  break;\n                case 20:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -19)\n                  break;\n                case 21:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -18);\n                  break;\n                case 22:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -17);\n                  break;\n                case 23:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -16);\n                  break;\n                case 24:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -15);\n                  break;\n                case 25:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -14);\n                  break;\n                case 26:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -13);\n                  break;\n                case 27:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -12);\n                  break;\n                case 28:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -11);\n                  break;\n                case 29:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -10);\n                  break;\n                case 30:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -9);\n                  break;\n                case 31:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -8);\n                  break;\n                case 32:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -7);\n                  break;\n                case 33:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -6)\n                  break;\n                case 34:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -5);\n                  break;\n                case 35:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -4);\n                  break;\n                case 36:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -3);\n                  break;\n                case 37:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -2);\n                  break;\n                case 38:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -1);\n                  break;\n                case 39:\n                  rate = 1;\n                  break;\n                case 40:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 1);\n                  break;\n                case 41:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 2);\n                  break;\n                case 42:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 3);\n                  break;\n                case 43:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 4);\n                  break;\n                case 44:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 5);\n                  break;\n                case 45:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 6);\n                  break;\n                case 46:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 7);\n                  break;\n                case 47:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 8);\n                  break;\n                case 48:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 9);\n                  break;\n                case 49:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 10);\n                  break;\n                case 50:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 11);\n                  break;\n                case 51:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 12);\n                  break;\n                case 52:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 13);\n                  break;\n                case 53:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 14);\n                  break;\n                case 54:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 15);\n                  break;\n                case 55:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 16);\n                  break;\n                case 56:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 17);\n                  break;\n                case 57:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 18);\n                  break;\n                case 58:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 19);\n                  break;\n                case 59:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 20);\n                  break;\n                case 60:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 21);\n                  break;\n                case 61:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 22);\n                  break;\n                case 62:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 23);\n                  break;\n                case 63:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 24);\n                  break;\n                case 64:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 25);\n                  break;\n                case 65:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 26);\n                  break;\n                case 66:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 27);\n                  break;\n                case 67:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 28);\n                  break;\n                case 68:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 29);\n                  break;\n                case 69:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 30);\n                  break;\n                case 70:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 31);\n                  break;\n                case 71:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 33);\n                  break;\n                case 77:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 34);\n                  break;\n                case 78:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 35);\n                  break;\n                case 79:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 36);\n                  break;\n                case 80:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 37);\n                  break;\n                case 81:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 38);\n                  break;\n                case 82:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 39);\n                  break;\n                case 83:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 40);\n                  break;\n                case 84:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 41);\n                  break;\n                case 85:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 42);\n                  break;\n                case 86:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 43);\n                  break;\n                case 87:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 44);\n                  break;\n                case 88:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 45);\n                  break;\n            }\n\n            return rate;\n        };\n\n        var _calculateElectricGuitarRate = function(guitarIndex) {\n            var rate = 0;\n\n            switch (guitarIndex - NUMBER_OF_ONESHOTS - NUMBER_OF_ONESHOTS) {\n                case 0:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -39);\n                  break;\n                case 1:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -38);\n                  break;\n                case 2:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -37);\n                  break;\n                case 3:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -36);\n                  break;\n                case 4:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -35);\n                  break;\n                case 5:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -34);\n                  break;\n                case 6:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -33);\n                  break;\n                case 7:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -32);\n                  break;\n                case 8:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -31);\n                  break;\n                case 9:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -30)\n                  break;\n                case 10:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -29);\n                  break;\n                case 11:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -28);\n                  break;\n                case 12:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -27);\n                  break;\n                case 13:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -26);\n                  break;\n                case 14:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -25);\n                  break;\n                case 15:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -24);\n                  break;\n                case 16:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -23);\n                  break;\n                case 17:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -22);\n                  break;\n                case 18:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -21);\n                  break;\n                case 19:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -20);\n                  break;\n                case 20:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -19)\n                  break;\n                case 21:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -18);\n                  break;\n                case 22:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -17);\n                  break;\n                case 23:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -16);\n                  break;\n                case 24:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -15);\n                  break;\n                case 25:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -14);\n                  break;\n                case 26:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -13);\n                  break;\n                case 27:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -12);\n                  break;\n                case 28:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -11);\n                  break;\n                case 29:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -10);\n                  break;\n                case 30:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -9);\n                  break;\n                case 31:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -8);\n                  break;\n                case 32:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -7);\n                  break;\n                case 33:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -6)\n                  break;\n                case 34:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -5);\n                  break;\n                case 35:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -4);\n                  break;\n                case 36:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -3);\n                  break;\n                case 37:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -2);\n                  break;\n                case 38:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), -1);\n                  break;\n                case 39:\n                  rate = 1;\n                  break;\n                case 40:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 1);\n                  break;\n                case 41:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 2);\n                  break;\n                case 42:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 3);\n                  break;\n                case 43:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 4);\n                  break;\n                case 44:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 5);\n                  break;\n                case 45:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 6);\n                  break;\n                case 46:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 7);\n                  break;\n                case 47:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 8);\n                  break;\n                case 48:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 9);\n                  break;\n                case 49:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 10);\n                  break;\n                case 50:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 11);\n                  break;\n                case 51:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 12);\n                  break;\n                case 52:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 13);\n                  break;\n                case 53:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 14);\n                  break;\n                case 54:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 15);\n                  break;\n                case 55:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 16);\n                  break;\n                case 56:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 17);\n                  break;\n                case 57:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 18);\n                  break;\n                case 58:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 19);\n                  break;\n                case 59:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 20);\n                  break;\n                case 60:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 21);\n                  break;\n                case 61:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 22);\n                  break;\n                case 62:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 23);\n                  break;\n                case 63:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 24);\n                  break;\n                case 64:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 25);\n                  break;\n                case 65:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 26);\n                  break;\n                case 66:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 27);\n                  break;\n                case 67:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 28);\n                  break;\n                case 68:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 29);\n                  break;\n                case 69:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 30);\n                  break;\n                case 70:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 31);\n                  break;\n                case 71:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 33);\n                  break;\n                case 77:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 34);\n                  break;\n                case 78:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 35);\n                  break;\n                case 79:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 36);\n                  break;\n                case 80:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 37);\n                  break;\n                case 81:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 38);\n                  break;\n                case 82:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 39);\n                  break;\n                case 83:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 40);\n                  break;\n                case 84:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 41);\n                  break;\n                case 85:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 42);\n                  break;\n                case 86:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 43);\n                  break;\n                case 87:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 44);\n                  break;\n                case 88:\n                  rate = 1 * Math.pow(Math.pow(2, (1 / 12)), 45);\n                  break;\n            }\n\n            return rate;\n        };\n\n        var _createOneshotSettings = function() {\n            var settings = new Array(NUMBER_OF_ONESHOTS);\n\n            for (var i = 0; i < NUMBER_OF_ONESHOTS; i++) {\n                var setting = {\n                    buffer : 0,\n                    rate   : 1,\n                    loop   : false,\n                    start  : 0,\n                    end    : 0,\n                    volume : 1\n                };\n\n                setting.buffer = _getBufferIndex(i);\n                setting.rate   = _calculatePianoRate(i);\n\n                settings[i] = setting;\n            }\n\n            for (var i = NUMBER_OF_ONESHOTS; i < (NUMBER_OF_ONESHOTS + NUMBER_OF_ONESHOTS); i++) {\n                var setting = {\n                    buffer : 7,\n                    rate   : 1,\n                    loop   : false,\n                    start  : 0,\n                    end    : 0,\n                    volume : 1\n                };\n\n                setting.rate = _calculateGuitarRate(i);\n\n                settings[i] = setting;\n            }\n\n            for (var i = (NUMBER_OF_ONESHOTS + NUMBER_OF_ONESHOTS); i < (NUMBER_OF_ONESHOTS + NUMBER_OF_ONESHOTS + NUMBER_OF_ONESHOTS); i++) {\n                var setting = {\n                    buffer : 8,\n                    rate   : 1,\n                    loop   : false,\n                    start  : 0,\n                    end    : 0,\n                    volume : 1\n                };\n\n                setting.rate = _calculateElectricGuitarRate(i);\n\n                settings[i] = setting;\n            }\n\n            return settings;\n        };\n\n        var _loadUI = function() {\n            $timeout(function() {\n                $scope.isReady = true;\n            });\n        };\n\n        var _loadRIRs = function() {\n            // Load impulse responses\n            var reverbs = [];\n\n            angular.forEach($scope.rirs, function(rir, index) {\n                X.ajax(rir.url, 'arraybuffer', AJAX_TIMEOUT, function(event, arrayBuffer) {\n                    X.decode(X.get(), arrayBuffer, function(audioBuffer) {\n                        reverbs.push(audioBuffer);\n\n                        $scope.$apply(function() {\n                            $scope.progress = Math.floor((reverbs.length / $scope.rirs.length) * 100);\n                            $scope.progressStyle.width = $scope.progress + '%';\n                        });\n\n                        if (reverbs.length === $scope.rirs.length) {\n                            angular.forEach(sources, function(source) {\n                                X(source).module('reverb').preset(reverbs);\n                            });\n\n                            C('oscillator').module('reverb').preset(reverbs);\n\n                            _loadUI();\n                        }\n                    }, function(error) {\n                        // Decode error\n                        _loadUI();\n                    });\n                }, function(event, textStatus) {\n                    openDialog('Error', 400, 'auto', true, '<p><b>The loading of RIRs failed.</b></p>');\n                });\n            });\n        };\n\n        // Load one-shot audio files\n        try {\n            X('oneshot').setup({\n                resources : _oneshots,\n                settings  : _createOneshotSettings(),\n                timeout   : AJAX_TIMEOUT,\n                success   : function(event, buffers) {\n                    // Can select one-shot audio (Piano)\n                    $scope.isEnableOneshot = true;\n\n                    // Next, Load RIRs\n                    if ($scope.rirs.length === 0) {\n                        _loadUI();\n                    } else {\n                        _loadRIRs();\n                    }\n                },\n                error : function(object, textStatus) {\n                    openDialog('Error', 400, 'auto', true, '<p><b>The loading of audio files failed.</b></p>');\n                },\n                progress : function(event) {\n                }\n            });\n        } catch (error) {\n            openDialog('Error', 400, 'auto', true, ('<p><b>' + error.message + '</b></p>'));\n        }\n\n        // This model is refered by other controllers.\n        $scope.currentSoundSource  = 'oscillator';\n        $scope.selectedSoundSource = 'oscillator';\n\n        $scope.isReady       = false;\n        $scope.progress      = 0;\n        $scope.progressStyle = {'width' : ($scope.progress + '%')};\n\n        $scope.isSafari = (function() {\n            var userAgent = navigator.userAgent.toLowerCase();\n\n            if ((userAgent.indexOf('chrome') === -1) && (userAgent.indexOf('safari') !== -1)) {\n                return true;\n            } else {\n                return false;\n            }\n        })();\n\n        $scope.isEnableOneshot = false;\n        $scope.isEndOpeing     = false;\n        $scope.isStart         = false;\n\n        $scope.progressWrapperStyle = {'padding' : (((Math.floor($window.innerHeight / 2) - 60) + 'px') + ' 0px')};\n        $scope.headerStyle          = {'top' : (parseInt(($window.innerHeight) / 4) + 'px')};\n\n        // Models for modal window directive\n        $scope.isModalProgressDecodeAudio   = false;\n        $scope.isModalProgressReadFile      = false;\n        $scope.isModalProgressSessionWait   = false;\n\n        // Models for Oscillator\n        $scope.oscillators                      = {};\n        $scope.oscillators.oscillator0          = {};\n        $scope.oscillators.oscillator0.isActive = true;\n        $scope.oscillators.oscillator0.type     = 'sawtooth';\n        $scope.oscillators.oscillator1          = {};\n        $scope.oscillators.oscillator1.isActive = false;\n        $scope.oscillators.oscillator1.type     = 'sawtooth';\n\n        $scope.readFileProgress = '';\n\n        // for Revreb\n        $scope.rirs = [\n            {url : (BASE_URL + 'impulse-responses/s1_r1_c.wav'), value :  1, label : '1 - 1', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r2_c.wav'), value :  2, label : '1 - 2', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r3_c.wav'), value :  3, label : '1 - 3', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r4_c.wav'), value :  4, label : '1 - 4', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r1_c.wav'), value :  5, label : '2 - 1', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r2_c.wav'), value :  6, label : '2 - 2', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r3_c.wav'), value :  7, label : '2 - 3', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r4_c.wav'), value :  8, label : '2 - 4', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r1_c.wav'), value :  9, label : '3 - 1', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r2_c.wav'), value : 10, label : '3 - 2', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r3_c.wav'), value : 11, label : '3 - 3', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r4_c.wav'), value : 12, label : '3 - 4', group : 'Sideways pointed cardioid measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r1_o.wav'), value : 13, label : '1 - 1', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r2_o.wav'), value : 14, label : '1 - 2', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r3_o.wav'), value : 15, label : '1 - 3', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r4_o.wav'), value : 16, label : '1 - 4', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r1_o.wav'), value : 17, label : '2 - 1', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r2_o.wav'), value : 18, label : '2 - 2', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r3_o.wav'), value : 19, label : '2 - 3', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r4_o.wav'), value : 20, label : '2 - 4', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r1_o.wav'), value : 21, label : '3 - 1', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r2_o.wav'), value : 22, label : '3 - 2', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r3_o.wav'), value : 23, label : '3 - 3', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r4_o.wav'), value : 24, label : '3 - 4', group : 'Omnidirectional measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_p1_o.wav'), value : 25, label : '1 - 1', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s1_p2_o.wav'), value : 26, label : '1 - 2', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s1_p3_o.wav'), value : 27, label : '1 - 3', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s2_p1_o.wav'), value : 28, label : '2 - 1', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s2_p2_o.wav'), value : 29, label : '2 - 2', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s2_p3_o.wav'), value : 30, label : '2 - 3', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s3_p1_o.wav'), value : 31, label : '3 - 1', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s3_p2_o.wav'), value : 32, label : '3 - 2', group : 'Omnidirectional measurements on the stage'},\n            {url : (BASE_URL + 'impulse-responses/s3_p3_o.wav'), value : 33, label : '3 - 3', group : 'Omnidirectional measurements on the stage'}\n            /*\n            {url : (BASE_URL + 'impulse-responses/s1_r1_b.wav'), value : 34, label : '1 - 1', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r2_b.wav'), value : 35, label : '1 - 2', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r3_b.wav'), value : 36, label : '1 - 3', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r4_b.wav'), value : 37, label : '1 - 4', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r1_b.wav'), value : 38, label : '2 - 1', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r2_b.wav'), value : 39, label : '2 - 2', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r3_b.wav'), value : 40, label : '2 - 3', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r4_b.wav'), value : 41, label : '2 - 4', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r1_b.wav'), value : 42, label : '3 - 1', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r2_b.wav'), value : 43, label : '3 - 2', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r3_b.wav'), value : 44, label : '3 - 3', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r4_b.wav'), value : 45, label : '3 - 4', group : 'Binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r1_bd.wav'), value : 46, label : '1 - 1', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r2_bd.wav'), value : 47, label : '1 - 2', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r3_bd.wav'), value : 48, label : '1 - 3', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s1_r4_bd.wav'), value : 49, label : '1 - 4', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r1_bd.wav'), value : 50, label : '2 - 1', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r2_bd.wav'), value : 51, label : '2 - 2', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r3_bd.wav'), value : 52, label : '2 - 3', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s2_r4_bd.wav'), value : 53, label : '2 - 4', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r1_bd.wav'), value : 54, label : '3 - 1', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r2_bd.wav'), value : 55, label : '3 - 2', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r3_bd.wav'), value : 56, label : '3 - 3', group : 'Diffuse field compensated binaural measurements in the audience area'},\n            {url : (BASE_URL + 'impulse-responses/s3_r4_bd.wav'), value : 57, label : '3 - 4', group : 'Diffuse field compensated binaural measurements in the audience area'}\n            */\n        ];\n\n        $scope.pianoKeyboards = {};\n        $scope.pianoKeyboards.keyboards = {\n                                                                                                                            'A-4' :  0, 'A-4h' :  1, 'B-4' :  2,\n            'C-3' :  3, 'C-3h' :  4, 'D-3' :  5, 'D-3h' :  6, 'E-3' :  7, 'F-3' :  8, 'F-3h' :  9, 'G-3' : 10, 'G-3h' : 11, 'A-3' : 12, 'A-3h' : 13, 'B-3' : 14,\n            'C-2' : 15, 'C-2h' : 16, 'D-2' : 17, 'D-2h' : 18, 'E-2' : 19, 'F-2' : 20, 'F-2h' : 21, 'G-2' : 22, 'G-2h' : 23, 'A-2' : 24, 'A-2h' : 25, 'B-2' : 26,\n            'C-1' : 27, 'C-1h' : 28, 'D-1' : 29, 'D-1h' : 30, 'E-1' : 31, 'F-1' : 32, 'F-1h' : 33, 'G-1' : 34, 'G-1h' : 35, 'A-1' : 36, 'A-1h' : 37, 'B-1' : 38,\n            'C'   : 39,   'Ch' : 40,   'D' : 41,   'Dh' : 42,   'E' : 43,   'F' : 44,   'Fh' : 45,   'G' : 46,   'Gh' : 47,   'A' : 48,   'Ah' : 49,   'B' : 50,\n            'C1'  : 51,  'C1h' : 52,  'D1' : 53,  'D1h' : 54,  'E1' : 55,  'F1' : 56,  'F1h' : 57,  'G1' : 58,  'G1h' : 59,  'A1' : 60,  'A1h' : 61,  'B1' : 62,\n            'C2'  : 63,  'C2h' : 64,  'D2' : 65,  'D2h' : 66,  'E2' : 67,  'F2' : 68,  'F2h' : 69,  'G2' : 70,  'G2h' : 71,  'A2' : 72,  'A2h' : 73,  'B2' : 74,\n            'C3'  : 75,  'C3h' : 76,  'D3' : 77,  'D3h' : 78,  'E3' : 79,  'F3' : 80,  'F3h' : 81,  'G3' : 82,  'G3h' : 83,  'A3' : 84,  'A3h' : 85,  'B3' : 86,\n            'C4'  : 87\n        };\n\n        $scope.pianoKeyboards.whites = [\n                                               'A-4', 'B-4',\n            'C-3', 'D-3', 'E-3', 'F-3', 'G-3', 'A-3', 'B-3',\n            'C-2', 'D-2', 'E-2', 'F-2', 'G-2', 'A-2', 'B-2',\n            'C-1', 'D-1', 'E-1', 'F-1', 'G-1', 'A-1', 'B-1',\n            'C',   'D',   'E',   'F',   'G',   'A',   'B',\n            'C1',  'D1',  'E1',  'F1',  'G1',  'A1',  'B1',\n            'C2',  'D2',  'E2',  'F2',  'G2',  'A2',  'B2',\n            'C3',  'D3',  'E3',  'F3',  'G3',  'A3',  'B3',\n            'C4'\n        ];\n\n        $scope.pianoKeyboards.blacks = [\n                                                    'A-4h', 'skip',\n            'C-3h', 'D-3h', 'skip', 'F-3h', 'G-3h', 'A-3h', 'skip',\n            'C-2h', 'D-2h', 'skip', 'F-2h', 'G-2h', 'A-2h', 'skip',\n            'C-1h', 'D-1h', 'skip', 'F-1h', 'G-1h', 'A-1h', 'skip',\n            'Ch',   'Dh',   'skip', 'Fh',   'Gh',   'Ah',   'skip',\n            'C1h',  'D1h',  'skip', 'F1h',  'G1h',  'A1h',  'skip',\n            'C2h',  'D2h',  'skip', 'F2h',  'G2h',  'A2h',  'skip',\n            'C3h',  'D3h',  'skip', 'F3h',  'G3h',  'A3h'\n        ];\n\n        $scope.isSoundStops = [];\n\n        angular.forEach($scope.pianoKeyboards.keyboards, function() {\n            $scope.isSoundStops.push(true);\n        });\n\n        /**\n         * This event handler is to start application.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.startApplication = function(event) {\n            event.preventDefault();\n\n            // X.setup();\n\n            $scope.isStart = true;\n\n            // This timeout is for animation.\n            $timeout(function() {\n                $scope.isEndOpening = true;\n            }, 2000);\n        };\n\n        /**\n         * This event handler is to start sound.\n         * @param {Event} event This argument is event object from ng-mousedown directive\n         * @param {number} index This argument is number between 0 and 87.\n         */\n        $scope.startSound = function(event, index) {\n            if (!X.IS_XSOUND || $(event.currentTarget).hasClass('skip')) {\n                return;  // .skip\n            }\n\n            if ((event.type === 'mouseover') && !_isDown) {\n                return;\n            }\n\n            if ($scope.currentSoundSource === 'oscillator') {\n                X('oscillator').ready(0, 0).start(X.toFrequencies(index));\n                C('oscillator').ready(0, 0).start(X.toFrequencies(index));\n\n                X('mixer').mix([X('oscillator'), C('oscillator')]);\n\n                X('mixer').module('recorder').start();\n                X('mixer').module('session').start();\n            } else if ($scope.currentSoundSource === 'piano') {\n                X('oneshot').ready(0, 0).start(index);\n\n                X('oneshot').module('recorder').start();\n                X('oneshot').module('session').start();\n            } else if ($scope.currentSoundSource === 'guitar') {\n                X('oneshot').ready(0, 0).start(index + 88);\n\n                X('oneshot').module('recorder').start();\n                X('oneshot').module('session').start();\n            } else if ($scope.currentSoundSource === 'electric-guitar') {\n                X('oneshot').ready(0, 0).start(index + 88 + 88);\n\n                X('oneshot').module('recorder').start();\n                X('oneshot').module('session').start();\n            } else if ($scope.currentSoundSource === 'whitenoise') {\n                X('noise').param('type', 'whitenoise').start();\n\n                X('noise').module('recorder').start();\n                X('noise').module('session').start();\n            } else if ($scope.currentSoundSource === 'pinknoise') {\n                X('noise').param('type', 'pinknoise').start();\n\n                X('noise').module('recorder').start();\n                X('noise').module('session').start();\n            } else if ($scope.currentSoundSource === 'browniannoise') {\n                X('noise').param('type', 'browniannoise').start();\n\n                X('noise').module('recorder').start();\n                X('noise').module('session').start();\n            }\n\n            $scope.isSoundStops[index] = false;\n\n            _isDown = true;\n        };\n\n        /**\n         * This event handler is to stop sound.\n         * @param {Event} event This argument is event object from ng-mouseup directive\n         * @param {number} index This argument is number between 0 and 87.\n         */\n        $scope.stopSound = function(event, index) {\n            if (!X.IS_XSOUND || $(event.currentTarget).hasClass('skip')) {\n                return;  // .skip\n            }\n\n            event.stopPropagation();\n\n            if ($scope.currentSoundSource === 'oscillator') {\n                X('oscillator').stop();\n                C('oscillator').stop();\n\n                // X('mixer').stop();\n            } else if ($scope.currentSoundSource === 'piano') {\n                X('oneshot').stop(index);\n            } else if ($scope.currentSoundSource === 'guitar') {\n                X('oneshot').stop(index + 88);\n            } else if ($scope.currentSoundSource === 'electric-guitar') {\n                X('oneshot').stop(index + 88 + 88);\n            } else {\n                X('noise').stop();\n            }\n\n            $scope.isSoundStops[index] = true;\n\n           if (event.type === 'mouseup') {\n               _isDown = false;\n           }\n        };\n\n        /**\n         * This function clears class attribute for piano keyboards.\n         */\n        $scope.clearKeyboards = function() {\n            angular.forEach($scope.isSoundStops, function(isSoundStop, index) {\n                $scope.isSoundStops[index] = true;\n            });\n        };\n\n        /**\n         * This event handler is to change oscillator state.\n         * @param {Event} event This argument is event object from ng-click directive.\n         * @param {number} number This argument is either 0 or 1.\n         */\n        $scope.toggleOscillatorState = function(event, number) {\n            var state = !$scope.oscillators['oscillator' + number].isActive;\n\n            switch (number) {\n                case 0 :\n                    angular.forEach([0, 1, 2, 3], function(index) {\n                        X('oscillator').get(index).state(state);\n                    });\n\n                    break;\n                case 1 :\n                    angular.forEach([0, 1, 2, 3], function(index) {\n                        C('oscillator').get(index).state(state);\n                    });\n\n                    break;\n                default :\n                    break;\n            }\n\n            $scope.oscillators['oscillator' + number].isActive = state;\n        };\n\n        /**\n         * This event handler is to change analyser state.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.toggleAnalyserState = function(event) {\n            $rootScope.isActives.visualization = !$scope.isActives.visualization;\n\n            angular.forEach(sources, function(source) {\n                if (source !== 'oscillator') {\n                    X(source).module('analyser').domain('time').state($rootScope.isActives.visualization);\n                    X(source).module('analyser').domain('fft').state($rootScope.isActives.visualization);\n                }\n            });\n        };\n\n        /**\n         * This event handler is to toggle displaying of MML controllers.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.toggleMMLState = function(event) {\n            $rootScope.isActives.mml = !$rootScope.isActives.mml;\n        };\n\n        /**\n         * This event handler is to open or close window for patch system.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.togglePatchState = function(event) {\n            $rootScope.isActives.patch = !$rootScope.isActives.patch;\n\n            if ($rootScope.isActives.patch) {\n                $('#patch-container').colorbox({\n                    open        : true,\n                    inline      : true,\n                    href        : '#patch-container',\n                    width       : '600px',\n                    height      : '480px',\n                    transition  : 'fade',\n                    speed       : 600,\n                    opacity     : 0.6,\n                    fadeOut     : 600,\n                    returnFocus : false,\n                    onOpen      : function() {\n                        // to PatchController\n                        $scope.$broadcast('onOpenPatchDialog');\n                    },\n                    onCleanup  : function() {\n                        $timeout(function() {\n                            $rootScope.isActives.patch = false;\n                        });\n                    }\n                });\n            }\n        };\n\n        /**\n         * This event handler is to change oscillator's wave type.\n         * @param {Event} event This argument is event object from ng-click directive.\n         * @param {number} number This argument is either 0 or 1.\n         * @param {string} type This argument is one of 'sine', 'square', 'sawtooth', 'triangle'.\n         */\n        $scope.changeWaveType = function(event, number, type) {\n            switch (number) {\n                case 0 :\n                    angular.forEach(oscillatorNumbers, function(number) {\n                        X('oscillator', number).param('type', type);\n                    });\n\n                    break;\n                case 1 :\n                    angular.forEach(oscillatorNumbers, function(number) {\n                        C('oscillator', number).param('type', type);\n                    });\n\n                    break;\n                default :\n                    break;\n            }\n\n            $scope.oscillators['oscillator' + number].type = type;\n        };\n\n        /**\n         * This event handler is to open file dialog.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.triggerFileUploader = function(event) {\n            $(event.currentTarget).prev('[type=\"file\"]').trigger('click');\n        };\n    }]);\n\n    /**\n     * Controller for Audio\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {function} createTimeString This argument is service of DI (Dependency Injection).\n     * @extends {XSoundController}\n     */\n    xsound.controller('AudioController', ['$rootScope', '$scope', '$timeout', 'createTimeString', function($rootScope, $scope, $timeout, createTimeString) {\n        var _decodeCallback = function(arrayBuffer) {\n            $timeout(function() {\n                $scope.$parent.isModalProgressDecodeAudio = true;\n            });\n        };\n\n        var _readyCallback = function(buffer) {\n            var duration = buffer.duration;\n\n            $timeout(function() {\n                // Close Modal Window\n                $scope.$parent.isModalProgressDecodeAudio = false;\n\n                // Change UI\n                $scope.isActive = false;\n\n                // Set audio duration time\n                $scope.duration = duration;\n\n                $scope.durationText    = createTimeString(duration);\n                $scope.currentTimeText = '00 : 00.00';\n            });\n        };\n\n        var _startCallback = function(source, currentTime) {\n            X('audio').module('recorder').start();\n            X('audio').module('session').start();\n\n            $timeout(function() {\n                $scope.isActive = true;\n            });\n        };\n\n        var _stopCallback = function(source, currentTime) {\n            $timeout(function() {\n                $scope.isActive = false;\n            });\n        };\n\n        var _updateCallback = function(source, currentTime) {\n            var index = Math.floor(currentTime * source.buffer.sampleRate);\n            var n100msec = 0.100 * source.buffer.sampleRate;\n\n            if ((index % n100msec) !== 0) {\n                return;\n            }\n\n            $timeout(function() {\n                $rootScope.currentTime = currentTime;\n                $scope.currentTimeText = createTimeString(currentTime);\n            });\n        };\n\n        var _endedCallback = function(source, currentTime) {\n            X('audio').module('analyser').domain('time-overview-L').update(0);\n            X('audio').module('analyser').domain('time-overview-R').update(0);\n\n            $timeout(function() {\n                $scope.isActive        = false;\n                $rootScope.currentTime = 0;\n                $scope.currentTimeText = '00 : 00.00';\n            });\n        };\n\n        X('audio').setup({\n            decode : _decodeCallback,\n            ready  : _readyCallback,\n            start  : _startCallback,\n            stop   : _stopCallback,\n            update : _updateCallback,\n            ended  : _endedCallback\n        });\n\n        $scope.currentTime     = 0;\n        $scope.currentTimeText = '00 : 00.00';\n        $scope.duration        = 0;\n        $scope.durationText    = '00 : 00.00';\n        $scope.isActive        = false;\n\n        /**\n         * Start or Pause audio\n         * @param {Event} event event object from ng-click directive\n         */\n        $scope.controlAudio = function(event) {\n            X('audio').toggle(X('audio').param('currentTime'));\n        };\n    }]);\n\n    /**\n     * Controller for Recorder\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {Array.<string>} sources This argument is scope of this controller.\n     * @param {function} openDialog This argument is scope of this controller.\n     * @param {function} createDateTimeString This argument is scope of this controller.\n     * @extends {XSoundController}\n     */\n    xsound.controller('RecordController', ['$scope', '$timeout', 'sources', 'openDialog', 'createDateTimeString', function($scope, $timeout, sources, openDialog, createDateTimeString) {\n        var _start = function() {\n            $('<div />').html('<p><b>Start recording in the TRACK ' + ($scope.activeTrack + 1) + ' . OK ?</b></p>').dialog({\n                title     : 'Confirmation',\n                autoOpen  : true,\n                show      : 'explode',\n                hide      : 'explode',\n                modal     : true,\n                width     : 400,\n                height    : 'auto',\n                draggable : true,\n                resizable : false,\n                zIndex    : 9999,\n                buttons   : {\n                    'START' : function() {\n                        angular.forEach(sources, function(source) {\n                            if (source !== 'oscillator') {\n                                X(source).module('recorder').ready($scope.activeTrack);\n\n                                if (source === 'stream') {\n                                    X('stream').module('recorder').start();\n                                }\n                            }\n                        });\n\n                        $timeout(function() {\n                            $scope.isActive = true;\n                        });\n\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    },\n                    'CANCEL' : function() {\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    }\n                }\n            });\n        };\n\n        var _stop = function() {\n            $('<div />').html('<p><b>Stop the recording. OK ?</b></p>').dialog({\n                title     : 'Confirmation',\n                autoOpen  : true,\n                show      : 'explode',\n                hide      : 'explode',\n                modal     : true,\n                width     : 400,\n                height    : 'auto',\n                draggable : true,\n                resizable : false,\n                zIndex    : 9999,\n                buttons   : {\n                    'STOP'  : function() {\n                        angular.forEach(sources, function(source) {\n                            if (source !== 'oscillator') {\n                                X(source).module('recorder').stop();\n                            }\n                        });\n\n                        $timeout(function() {\n                            $scope.isActive = false;\n                        });\n\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    },\n                    'CANCEL' : function() {\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    }\n                }\n            });\n        };\n\n        $scope.isActive    = false;\n        $scope.tracks      = [1, 2, 3, 4];\n        $scope.activeTrack = 0;\n        $scope.objectURL   = '';\n        $scope.finename    = '';\n\n        angular.forEach(sources, function(source) {\n            if (source !== 'oscillator') {\n                X(source).module('recorder').setup($scope.tracks.length);\n            }\n        });\n\n        /**\n         * Start or Stop recording\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.controlRecord = function(event) {\n            event.preventDefault();\n\n            if ($scope.isActive) {\n                _stop();\n            } else {\n                _start();\n            }\n        };\n\n        /**\n         * This function creates WAVE file.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.createWAVE = function(event) {\n            event.preventDefault();\n\n            if ($scope.isActive) {\n                // In the case of recording\n                return;\n            }\n\n            var CHANNEL = 2;\n            var BIT     = 16;  // 16 bit\n            var TYPE    = 'objectURL';\n\n            angular.forEach(sources, function(source) {\n                if (source !== 'oscillator') {\n                    var objectURL = X(source).module('recorder').create('all', BIT, CHANNEL, TYPE);\n\n                    if (objectURL) {\n                        $scope.objectURL = objectURL;\n\n                        var audio = new Audio($scope.objectURL);\n\n                        audio.setAttribute('controls', false);\n                        audio.play();\n                    }\n                }\n            });\n        };\n\n        /**\n         * This function opens download dialog.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.downloadWAVE = function(event) {\n            if ($scope.isActive) {\n                // In the case of recording\n                event.preventDefault();\n                return;\n            }\n\n            if ($scope.objectURL) {\n                $scope.filename = 'recorded-' + createDateTimeString() + '.wav';\n\n                //\n                // Canceling event is not necessary for downloading file\n                //\n                // event.preventDefault();\n            } else {\n                event.preventDefault();\n                openDialog('Error', 450, 'auto', true, '<p><b>The recorded sound data does not exists.</b></p>');\n            }\n        };\n\n        /**\n         * This function clears record track.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.clearTrack = function(event) {\n            event.preventDefault();\n\n            if ($scope.isActive) {\n                // In the case of recording\n                return;\n            }\n\n            $('<div />').html('<p><b>Clear the TRACK ' + ($scope.activeTrack + 1) + ' . OK ?</b></p>').dialog({\n                title     : 'Confirmation',\n                autoOpen  : true,\n                show      : 'explode',\n                hide      : 'explode',\n                modal     : true,\n                width     : 400,\n                height    : 'auto',\n                draggable : true,\n                resizable : false,\n                zIndex    : 9999,\n                buttons   : {\n                    'CLEAR' : function() {\n                        angular.forEach(sources, function(source) {\n                            if (source !== 'oscillator') {\n                                X(source).module('recorder').clear($scope.activeTrack);\n                            }\n                        });\n\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    },\n                    'CANCEL' : function() {\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    }\n                }\n            });\n        };\n    }]);\n\n    /*\n     * Controller for Visualization\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$document} $document This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {Array.<string>} sources readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {function} drawNodeCallback This argument is service of DI (Dependency Injection).\n     * @extends {XSoundController}\n     */\n    xsound.controller('VisualizationController', ['$rootScope', '$scope', '$document', '$timeout', 'sources', 'drawNodeCallback', function($rootScope, $scope, $document, $timeout, sources, drawNodeCallback) {\n        $scope.api     = 'canvas';\n        $scope.channel = 'left';\n\n        /**\n         * This function initializes analyser each domain (\"time\" and \"fft\").\n         * @param {string} source This argument is sound source name that is defined by XSound.js\n         * @param {string} api This argument is either 'canvas' or 'svg'.\n         */\n        $scope.setRealTimeAnalyser = function(source, api) {\n            X(source).module('analyser').param({\n                fftSize               : 2048,\n                minDecibels           : -100,\n                maxDecibels           : -30,\n                smoothingTimeConstant : 0.1\n            });\n\n            X(source).module('analyser').domain('time').setup($document[0].getElementById(api + '-time')).param({\n                interval : 0,\n                shape    : 'line',\n                wave     : 'rgba(0, 0, 255, 1.0)',\n                font     : {\n                    family : 'Arial',\n                    size   : '12px',\n                    style  : 'normal',\n                    weight : 'normal'\n                },\n                width    : 2,\n                right    : 15,\n                type     : 'uint'\n            });\n\n            X(source).module('analyser').domain('fft').setup($document[0].getElementById(api + '-spectrum')).param({\n                interval : 0,\n                shape    : 'rect',\n                wave     : 'gradient',\n                grad     : [\n                    {offset : 0, color : 'rgba(0, 128, 255, 1.0)'},\n                    {offset : 1, color : 'rgba(0,   0, 255, 1.0)'}\n                ],\n                font     : {\n                    family : 'Arial',\n                    size   : '12px',\n                    style  : 'normal',\n                    weight : 'normal'\n                },\n                width    : 1,\n                right    : 15,\n                type     : 'uint',\n                size     : 256\n            });\n        };\n\n        /**\n         * This function initializes analyser each domain (\"time-overview-L\" and \"time-overview-R\").\n         * @param {string} api This argument is either 'canvas' or 'svg'.\n         */\n       $scope.setAnalyser = function(api) {\n            X('audio').module('analyser').domain('time-overview-L').setup($document[0].getElementById(api + '-time-overview-L')).state(true).param({\n                shape : 'rect',\n                wave  : (api === 'canvas') ? 'gradient' : 'rgba(0, 0, 255, 1)',\n                grad  : [\n                    {offset : 0, color : 'rgba(0, 128, 255, 1.0)'},\n                    {offset : 1, color : 'rgba(0,   0, 255, 1.0)'}\n                ],\n                font  : {\n                    family : 'Arial',\n                    size   : '12px',\n                    style  : 'normal',\n                    weight : 'normal'\n                },\n                width : 0.5,\n                right : 15\n            });\n\n            X('audio').module('analyser').domain('time-overview-R').setup($document[0].getElementById(api + '-time-overview-R')).state(true).param({\n                shape : 'rect',\n                wave  : (api === 'canvas') ? 'gradient' : 'rgba(0, 0, 255, 1)',\n                grad  : [\n                    {offset : 0, color : 'rgba(0, 128, 255, 1.0)'},\n                    {offset : 1, color : 'rgba(0,   0, 255, 1.0)'}\n                ],\n                font  : {\n                    family : 'Arial',\n                    size   : '12px',\n                    style  : 'normal',\n                    weight : 'normal'\n                },\n                width : 0.5,\n                right : 15\n            });\n        };\n\n        /**\n         * This event handler is to change `update` mode or `sprite` mode\n         */\n        $scope.toggleSpriteMode = function() {\n            if ($rootScope.isActives.sprite) {\n                $rootScope.isActives.sprite = false;\n\n                $timeout(function() {\n                    X('audio').module('analyser').domain('time-overview-L').param('mode', 'update');\n                    X('audio').module('analyser').domain('time-overview-R').param('mode', 'update');\n                });\n            } else {\n                $rootScope.isActives.sprite = true;\n\n                $timeout(function() {\n                    X('audio').module('analyser').domain('time-overview-L').param('mode', 'sprite');\n                    X('audio').module('analyser').domain('time-overview-R').param('mode', 'sprite');\n                });\n            }\n        }\n\n        /**\n         * This function sets API for drawing.\n         * @param {string} api This argument is either 'canvas' or 'svg'.\n         */\n        $scope.selectAPI = function(api) {\n            $scope.api = api;\n\n            angular.forEach(sources, function(source) {\n                if (source !== 'oscillator') {\n                    $scope.setRealTimeAnalyser(source, api);\n                }\n            });\n\n            $scope.setAnalyser(api);\n\n            // Set current time\n            X('audio').module('analyser').domain('time-overview-L').drag(function(event, startTime, endTime) {\n                drawNodeCallback($timeout, X('audio').module('analyser').domain('time-overview-L').param('mode'), event, startTime, endTime);\n            });\n\n            X('audio').module('analyser').domain('time-overview-R').drag(function(event, startTime, endTime) {\n                drawNodeCallback($timeout, X('audio').module('analyser').domain('time-overview-R').param('mode'), event, startTime, endTime);\n            });\n        };\n\n        /**\n         * This event handler is to change channel (Left or Right) for displaying audio wave.\n         * @param {Event} event This argument is event object from ng-click directive.\n         * @param {string} channel This argument is either 'left' or 'right'\n         */\n        $scope.toggleAnalyserChannel = function(event, channel) {\n            event.preventDefault();\n            $scope.channel = channel;\n        };\n\n        // Initialization\n        $scope.selectAPI('canvas');\n    }]);\n\n    /**\n     * Controller for MML\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$http} $http This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {$sce} $timeout This argument is to render HTML.\n     * @param {string} BASE_URL This argument is service of DI (Dependency Injection).\n     * @param {Array.<string>} oscillatorNumbers This is the array of number in order to identify oscillator.\n     * @param {function} createDateTimeString This argument is service of DI (Dependency Injection).\n     * @extends {XSoundController}\n     */\n    xsound.controller('MMLController', ['$rootScope', '$scope', '$http', '$timeout', '$sce', 'BASE_URL', 'oscillatorNumbers', 'createDateTimeString', function($rootScope, $scope, $http, $timeout, $sce, BASE_URL, oscillatorNumbers, createDateTimeString) {\n        var _startCallbackMelody =  function(sequence) {\n            if ($scope.$parent.currentSoundSource === 'oscillator') {\n                X('mixer').mix([X('oscillator'), C('oscillator')]);\n            }\n\n            var mmls = $scope.mml.split(/\\|+/);\n\n            if (mmls.length === 2) {\n                var mml1 = mmls[0].replace(' ' + sequence.note,  ' <span class=\"highlight\">' + sequence.note + '</span>');\n\n                $scope.mml = mml1 + '|||||' + mmls[1];\n            } else if (mmls.length === 1) {\n                var mml1 = mmls[0].replace(' ' + sequence.note,  ' <span class=\"highlight\">' + sequence.note + '</span>');\n\n                $scope.mml = mml1;\n            }\n\n            angular.forEach(sequence.indexes, function(index) {\n                if (index === 'R') {\n                    return;\n                }\n\n                $timeout(function() {\n                    $scope.$parent.isSoundStops[index] = false;\n                });\n            });\n        };\n\n        var _startCallbackBass =  function(sequence) {\n            var mmls = $scope.mml.split(/\\|+/);\n\n            if (mmls.length === 2) {\n                var mml2 = mmls[1].replace(' ' + sequence.note,  ' <span class=\"highlight\">' + sequence.note + '</span>');\n\n                $scope.mml = mmls[0] + '|||||' + mml2;\n            }\n\n            angular.forEach(sequence.indexes, function(index) {\n                if (index === 'R') {\n                    return;\n                }\n\n                $timeout(function() {\n                    $scope.$parent.isSoundStops[index] = false;\n                });\n            });\n        };\n\n        var _stopCallback = function(sequence) {\n            sequence.indexes.forEach(function(index) {\n                if (index === 'R') {\n                    return;\n                }\n\n                $timeout(function() {\n                    $scope.$parent.isSoundStops[index] = true;\n                });\n            });\n        };\n\n        var _endedCallback = function() {\n            angular.forEach(oscillatorNumbers, function(number) {\n                if (number !== 0) {\n                    X('oscillator', number).state(false);\n                    C('oscillator', number).state(false);\n                }\n            });\n\n            $scope.readyMML();\n\n            $scope.paused = true;\n            $scope.$parent.clearKeyboards();\n        };\n\n        var _errorCallback = function(error, note) {\n            switch (error) {\n                case 'TEMPO'  :\n                case 'OCTAVE' :\n                case 'NOTE'   :\n                    //$scope.error = 'Maybe, ' + note + ' is invalid.';\n                    break;\n                case 'MML' :\n                    break;\n                default    :\n                    //$scope.error = 'The designated MML is invalid.';\n                    break;\n            }\n        };\n\n        X('mml').setup({\n            start : _startCallbackMelody,\n            stop  : _stopCallback,\n            ended : _endedCallback,\n            error : _errorCallback\n        });\n\n        C('mml').setup({\n            start : _startCallbackBass,\n            stop  : _stopCallback,\n            ended : _endedCallback,\n            error : _errorCallback\n        });\n\n        $scope.paused   = true;\n        $scope.mml      = '';\n        $scope.dataURL  = '';\n        $scope.filename = '';\n        $scope.error    = '';\n\n        $scope.trustAsHtml = function(string) {\n            return $sce.trustAsHtml(string);\n        };\n\n        // Chnage sound source -> parse MML text\n        $scope.$watch(function() {\n            return $scope.$parent.currentSoundSource;\n        }, function() {\n            $scope.readyMML();\n        });\n\n        // Get MML tex for placeholder\n        $http.get(Math.floor(Math.random() * 2) ? (BASE_URL + 'mml/mml-foreverlove.txt') : (BASE_URL + 'mml/mml-tears.txt'))\n             .then(function(response) {\n                 $scope.mml = response.data;\n                 $scope.readyMML();\n                 $scope.paused = true;\n             })\n             .catch(function(response) {\n             });\n\n        /**\n         * This event hander is to update MML text.\n         * @param {Event} event This argument is event object from ng-keyup directive.\n         */\n        $scope.typeMML = function(event) {\n            $scope.mml = event.currentTarget.textContent;\n            $scope.readyMML();\n            $scope.paused = true;\n        };\n\n        /**\n         * This function parses MML text and sets performance information.\n         */\n        $scope.readyMML = function() {\n            var mmls = $scope.mml.split(/\\|+/);\n\n            if ($scope.$parent.currentSoundSource === 'oscillator') {\n                if (mmls.length > 1) {\n                    X('mml').ready(X('oscillator'), mmls[0]);\n                    C('mml').ready(C('oscillator'), mmls[1]);\n                } else if (mmls.length > 0) {\n                    X('mml').ready(X('oscillator'), mmls[0]);\n                    C('mml').ready(C('oscillator'), []);\n                }\n            } else if ($scope.$parent.currentSoundSource === 'piano') {\n                if (mmls.length > 1) {\n                    X('mml').ready(X('oneshot'), mmls[0], 0);\n                    C('mml').ready(X('oneshot'), mmls[1], 0);\n                } else if (mmls.length > 0) {\n                    X('mml').ready(X('oneshot'), mmls[0], 0);\n                    C('mml').ready(X('oneshot'), [], 0);\n                }\n            } else if ($scope.$parent.currentSoundSource === 'guitar') {\n                if (mmls.length > 1) {\n                    X('mml').ready(X('oneshot'), mmls[0], 88);\n                    C('mml').ready(X('oneshot'), mmls[1], 88);\n                } else if (mmls.length > 0) {\n                    X('mml').ready(X('oneshot'), mmls[0], 88);\n                    C('mml').ready(X('oneshot'), [], 88);\n                }\n            } else if ($scope.$parent.currentSoundSource === 'electric-guitar') {\n                if (mmls.length > 1) {\n                    X('mml').ready(X('oneshot'), mmls[0], 88 + 88);\n                    C('mml').ready(X('oneshot'), mmls[1], 88 + 88);\n                } else if (mmls.length > 0) {\n                    X('mml').ready(X('oneshot'), mmls[0], 88 + 88);\n                    C('mml').ready(X('oneshot'), [], 88 + 88);\n                }\n            }\n        };\n\n        /**\n         * Start or Pause MML\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.controlMML = function(event) {\n            event.preventDefault();\n\n            if (!X('mml').isSequences()) {\n                return;\n            }\n\n            var parts = X('mml').get();\n\n            if ($scope.paused) {\n                // Start MML\n                if ($scope.$parent.currentSoundSource === 'oscillator') {\n                    angular.forEach(oscillatorNumbers, function(number) {\n                        X('oscillator', number).state(true);\n                        C('oscillator', number).state(true);\n                    });\n\n                    $scope.$parent.oscillators.oscillator0.isActive = true;\n                    $scope.$parent.oscillators.oscillator1.isActive = true;\n\n                    if (X('mml').get().length > 0) {\n                        X('mml').start(0);\n                    }\n\n                    if (C('mml').get().length > 0) {\n                        C('mml').start(0);\n                    }\n\n                    X('mixer').module('recorder').start();\n                    X('mixer').module('session').start();\n                } else {\n                    if (X('mml').get().length > 0) {\n                        X('mml').start(0);\n                    }\n\n                    if (C('mml').get().length > 0) {\n                        C('mml').start(0);\n                    }\n\n                    X('oneshot').module('recorder').start();\n                    X('oneshot').module('session').start();\n                }\n\n                $scope.paused = false;\n            } else {\n                // Stop MML\n                X('mml').stop();\n                C('mml').stop();\n\n                angular.forEach(oscillatorNumbers, function(number) {\n                    X('oscillator', number).state(true);\n                    C('oscillator', number).state(true);\n                });\n\n                $scope.paused = true;\n            }\n        };\n\n        /**\n         * Stop and Rewind MML\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.stopMML = function(event) {\n            // Stop MML\n            X('mml').stop();\n            C('mml').stop();\n\n            // Rewind\n            $scope.readyMML();\n\n            $scope.paused = true;\n            $scope.$parent.clearKeyboards();\n        };\n\n        /**\n         * This function opens download dialog.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.downloadMML = function(event) {\n            if ($scope.mml.trim().length === 0) {\n                event.preventDefault();\n                return;\n            }\n\n            $scope.dataURL  = X.toTextFile($scope.mml);\n            $scope.filename = 'mml-' + createDateTimeString() + '.txt';\n\n            //\n            // Canceling event is not necessary for downloading file\n            //\n            // event.preventDefault();\n        };\n    }]);\n\n    /**\n     * Controller for Session\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$location} $location This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {Array.<string>} sources readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {function} openDialog This argument is service of DI (Dependency Injection).\n     * @extends {XSoundController}\n     */\n    xsound.controller('SessionController', ['$scope', '$location', '$timeout', 'sources', 'openDialog', function($scope, $location, $timeout, sources, openDialog) {\n        // for WebSocket\n        var IS_TLS = false;\n        var HOST   = '';\n        var PATH   = '';\n\n        if ($location.host().indexOf('localhost') !== -1) {\n            IS_TLS = false;\n            HOST   = 'localhost';\n            PATH   = '';\n        } else {\n            IS_TLS = true;\n            HOST   = 'x-sound-server.herokuapp.com/';\n            PATH   = '/app/websocket/';\n        }\n\n        var _openCallback = function(event) {\n            openDialog('Confirmation', 800, 'auto', false, ('<p><b>Connection to (' + event.currentTarget.url + ') succeeded.</b></p>'));\n\n            $timeout(function() {\n                $scope.isActive = true;\n            });\n        };\n\n        var _closeCallback = function(event) {\n            openDialog('Confirmation', 400, 'auto', true, '<p><b>Connection closed.</b></p>');\n\n            $timeout(function() {\n                $scope.isActive = false;\n            });\n        };\n\n        var _errorCallback = function(event) {\n            openDialog('Error', 400, 'auto', true, '<p><b>Server Error.</b></p>');\n\n            $timeout(function() {\n                $scope.isActive = false;\n            });\n        };\n\n        var _stateCallback = function() {\n            $timeout(function() {\n                $scope.$parent.isModalProgressSessionWait = false;\n\n                if (X('mixer').module('session').state()) {\n                    $scope.isActive = true;\n                } else {\n                    $scope.isActive = false;\n                }\n            });\n        };\n\n        var _waitCallback = function(arrayBuffer) {\n            $scope.$parent.isModalProgressSessionWait = true;\n        };\n\n        $scope.isActive = false;\n        $scope.url      = '';\n\n        /**\n         * This event handler is to change session state.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.toggleSessionState = function(event) {\n            $scope.isActive = !$scope.isActive;\n\n            if ($scope.isActive) {\n                if (X('mixer').module('session').isConnected() &&\n                    X('oneshot').module('session').isConnected() &&\n                    X('audio').module('session').isConnected() &&\n                    X('stream').module('session').isConnected()) {\n                    // Connection to server has existed already\n                    angular.forEach(sources, function(source) {\n                        if (source !== 'oscillator') {\n                            X(source).module('session').state(true, _stateCallback, _waitCallback);\n                        }\n                    });\n                } else {\n                    var _sessionSetups = {\n                        tls   : IS_TLS,\n                        host  : HOST,\n                        port  : 8000,\n                        path  : PATH,\n                        open  : _openCallback,\n                        close : _closeCallback,\n                        error : _errorCallback\n                    };\n\n                    // The 1st\n                    try {\n                        angular.forEach(sources, function(source) {\n                            if (source !== 'oscillator') {\n                                X(source).module('session')\n                                          .setup(_sessionSetups)\n                                          .state(true, _stateCallback, _waitCallback);\n\n                                _sessionSetups.port++;\n                            }\n                        });\n                    } catch (error) {\n                        $scope.isActive = false;\n                        openDialog('Error', 400, 'auto', true, '<p><b>' + error.message + '</b></p>');\n                    }\n                }\n            } else {\n                angular.forEach(sources, function(source) {\n                    if (source !== 'oscillator') {\n                        X(source).module('session').state(false, _stateCallback, _waitCallback);\n                    }\n                });\n            }\n        };\n    }]);\n\n    /**\n     * Controller for  Account and Patch system\n     * @param {$rootScope} $rootScope This argument is service of DI (Dependency Injection).\n     * @param {$scope} $scope This argument is scope of this controller.\n     * @param {$http} $http This argument is service of DI (Dependency Injection).\n     * @param {$window} $window This argument is service of DI (Dependency Injection).\n     * @param {$location} $location This argument is service of DI (Dependency Injection).\n     * @param {$timeout} $timeout This argument is to update view.\n     * @param {Array.<string>} sources readFileByDragAndDrop This argument is service of DI (Dependency Injection).\n     * @param {function} openDialog This argument is service of DI (Dependency Injection).\n     * @param {function} getCurrentPatches This argument is service of DI (Dependency Injection).\n     * @extends {XSoundController}\n     */\n    xsound.controller('PatchController', ['$rootScope', '$scope', '$http', '$window', '$location', '$timeout', 'sources', 'openDialog', 'getCurrentPatches', function($rootScope, $scope, $http, $window, $location, $timeout, sources, openDialog, getCurrentPatches) {\n        var TIMEOUT = 10000;\n\n        var POST_ORIGIN = (function() {\n            if ($location.host().indexOf('localhost') !== -1) {\n                // return 'http://localhost:3000';                                                       // Node.js + MongoDB\n                return 'http://localhost/~korilakkuma/portfolio-x-sound-server/php/bootstrap.php';  // PHP + MySQL\n            } else {\n                // return 'http://curtaincall.c.node-ninja.com:3000';                                            // Node.js + MongoDB\n                return 'https://weblike-curtaincall.ssl-lolipop.jp/portfolio-x-sound-server/php/bootstrap.php';  // PHP + MySQL\n            }\n        })();\n\n        var _defaultPatches = getCurrentPatches();\n\n        var _deleteAccount = function() {\n            $scope.isDisabled = true;\n\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/account/delete'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    'username' : $scope.deleteAccounts.username,\n                    'password' : $scope.deleteAccounts.password,\n                    '_csrf'    : $scope.csrf\n                },\n                headers         : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf           = data.csrf;\n                    $scope.isAuth         = data.isAuth;\n                    $scope.authedUsername = data.username;\n\n                    if (!$scope.isAuth) {\n                        angular.forEach(data.message, function(message) {\n                            openDialog('Confirmation', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                        });\n                    }\n                }\n\n                $scope.isDisabled = false;\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf = data.csrf;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n\n                $scope.isDisabled = false;\n            });\n        };\n\n        var _loadPatch = function(patches, isPushState) {\n            if (!angular.isObject(patches)) {\n                return;\n            }\n\n            var setState = function(module, state) {\n                angular.forEach(sources, function(source) {\n                    X(source).module(module).state(state);\n                });\n\n                C('oscillator').module(module).state(state);\n\n                if (state) {\n                    $('[effector=\"' + module + '\"]').addClass('check-on');\n                } else {\n                    $('[effector=\"' + module + '\"]').removeClass('check-on');\n                }\n            };\n\n            if ('mastervolume' in patches) {\n                $('.slider-mastervolume:not(:first)').slider('value', patches.mastervolume);\n            }\n\n            if ('glide' in patches) {\n                var glide = patches.glide;\n\n                if ('time' in glide) {\n                    $('.slider-glide-time').slider('value', glide.time);\n                }\n            }\n\n            if ('envelopegenerator' in patches) {\n                var envelopegenerator = patches.envelopegenerator;\n\n                if ('attack'  in envelopegenerator) {$('.slider-envelopegenerator-attack').slider('value', envelopegenerator.attack);}\n                if ('decay'   in envelopegenerator) {$('.slider-envelopegenerator-decay').slider('value', envelopegenerator.decay);}\n                if ('sustain' in envelopegenerator) {$('.slider-envelopegenerator-sustain').slider('value', envelopegenerator.sustain);}\n                if ('release' in envelopegenerator) {$('.slider-envelopegenerator-release').slider('value', envelopegenerator.release);}\n            }\n\n            if ('oscillator0' in patches) {\n                var oscillator0 = patches.oscillator0;\n\n                if ('state' in oscillator0) {\n                    $timeout(function() {\n                        $scope.$parent.oscillators.oscillator0.isActive = !oscillator0;\n                        $scope.$parent.toggleOscillatorState(null, 0);\n                    });\n                }\n\n                if ('type' in oscillator0) {\n                    $timeout(function() {\n                        $scope.$parent.changeWaveType(null, 0, oscillator0.type);\n                    });\n                }\n\n                if ('gain'   in oscillator0) {$('.slider-volume:first').slider('value', oscillator0.gain);}\n                if ('octave' in oscillator0) {$('.slider-octave:first').slider('value', oscillator0.octave);}\n                if ('fine'   in oscillator0) {$('.slider-fine:first').slider('value', oscillator0.fine);}\n            }\n\n            if ('oscillator1' in patches) {\n                var oscillator1 = patches.oscillator1;\n\n                if ('state' in oscillator1) {\n                    $timeout(function() {\n                        $scope.$parent.oscillators.oscillator1.isActive = !oscillator1;\n                        $scope.$parent.toggleOscillatorState(null, 1);\n                    });\n                }\n\n                if ('type'in oscillator1) {\n                    $timeout(function() {\n                        $scope.$parent.changeWaveType(null, 1, oscillator1.type);\n                    });\n                }\n\n                if ('gain'   in oscillator1) {$('.slider-volume:last').slider('value', oscillator1.gain);}\n                if ('octave' in oscillator1) {$('.slider-octave:last').slider('value', oscillator1.octave);}\n                if ('fine'   in oscillator1) {$('.slider-fine:last').slider('value', oscillator1.fine);}\n            }\n\n            if ('compressor' in patches) {\n                var compressor = patches.compressor;\n\n                if ('state'     in compressor) {setState('compressor', compressor.state);}\n                if ('threshold' in compressor) {$('.slider-threshold').slider('value', compressor.threshold);}\n                if ('knee'      in compressor) {$('.slider-knee').slider('value', compressor.knee);}\n                if ('ratio'     in compressor) {$('.slider-ratio').slider('value', compressor.ratio);}\n                if ('attack'    in compressor) {$('.slider-compressor-attack').slider('value', compressor.attack);}\n                if ('release'   in compressor) {$('.slider-compressor-release').slider('value', compressor.release);}\n            }\n\n            if ('distortion' in patches) {\n                var distortion = patches.distortion;\n\n                if ('state'   in distortion) {setState('distortion', distortion.state);}\n                if ('curve'   in distortion) {$('#select-distortion-type').val(distortion.curve).trigger('change');}\n                if ('samples' in distortion) {$('#select-distortion-sample').val('value', distortion.samples);}\n                if ('drive'   in distortion) {$('.slider-distortion-drive').slider('value', distortion.drive);}\n                if ('color'   in distortion) {$('.slider-distortion-color').slider('value', distortion.color);}\n                if ('tone'    in distortion) {$('.slider-distortion-tone').slider('value', distortion.tone);}\n            }\n\n            if ('wah' in patches) {\n                var wah = patches.wah;\n\n                if ('state'     in wah) {setState('wah', wah.state);}\n                if ('cutoff'    in wah) {$('.slider-wah-cutoff').slider('value', wah.cutoff);}\n                if ('depth'     in wah) {$('.slider-wah-depth').slider('value', wah.depth);}\n                if ('rate'      in wah) {$('.slider-wah-rate').slider('value', wah.rate);}\n                if ('resonance' in wah) {$('.slider-wah-resonance').slider('value', wah.resonance);}\n            }\n\n            if ('equalizer' in patches) {\n                var equalizer = patches.equalizer;\n\n                if ('state'    in equalizer) {setState('equalizer', equalizer.state);}\n                if ('bass'     in equalizer) {$('.slider-equalizer-bass').slider('value', equalizer.bass);}\n                if ('middle'   in equalizer) {$('.slider-equalizer-middle').slider('value', equalizer.middle);}\n                if ('treble'   in equalizer) {$('.slider-equalizer-treble').slider('value', equalizer.treble);}\n                if ('presence' in equalizer) {$('.slider-equalizer-presence').slider('value', equalizer.presence);}\n            }\n\n            if ('filter' in patches) {\n                var filter = patches.filter;\n\n                if ('state'     in filter) {setState('filter', filter.state);}\n                if ('type'      in filter) {$('#select-filter-type').val(filter.type).trigger('change');}\n                if ('frequency' in filter) {$('.slider-filter-cutoff').slider('value', filter.frequency);}\n                if ('Q'         in filter) {$('.slider-filter-Q').slider('value', filter.Q);}\n                if ('gain'      in filter) {$('.slider-filter-gain').slider('value', filter.gain);}\n                if ('attack'    in filter) {$('.slider-filter-attack').slider('value', filter.attack);}\n                if ('decay'     in filter) {$('.slider-filter-decay').slider('value', filter.decay);}\n                if ('sustain'   in filter) {$('.slider-filter-sustain').slider('value', filter.sustain);}\n                if ('release'   in filter) {$('.slider-filter-release').slider('value', filter.release);}\n            }\n\n            if ('autopanner' in patches) {\n                var autopanner = patches.autopanner;\n\n                if ('state' in autopanner) {setState('autopanner', autopanner.state);}\n                if ('depth' in autopanner) {$('.slider-autopanner-depth').slider('value', autopanner.depth);}\n                if ('rate'  in autopanner) {$('.slider-autopanner-rate').slider('value', autopanner.rate);}\n            }\n\n            if ('tremolo' in patches) {\n                var tremolo = patches.tremolo;\n\n                if ('state' in tremolo) {setState('tremolo', tremolo.state);}\n                if ('depth' in tremolo) {$('.slider-tremolo-depth').slider('value', tremolo.depth);}\n                if ('rate'  in tremolo) {$('.slider-tremolo-rate').slider('value', tremolo.rate);}\n            }\n\n            if ('ringmodulator' in patches) {\n                var ringmodulator = patches.ringmodulator;\n\n                if ('state' in ringmodulator) {setState('ringmodulator', ringmodulator.state);}\n                if ('depth' in ringmodulator) {$('.slider-ringmodulator-depth').slider('value', ringmodulator.depth);}\n                if ('rate'  in ringmodulator) {$('.slider-ringmodulator-rate').slider('value', ringmodulator.rate);}\n            }\n\n            if ('phaser' in patches) {\n                var phaser = patches.phaser;\n\n                if ('state'     in phaser) {setState('phaser', phaser.state);}\n                if ('stage'     in phaser) {$('.select-phaser-stage').val(phaser.stage);}\n                if ('frequency' in phaser) {$('.slider-phaser-cutoff').slider('value', phaser.frequency);}\n                if ('depth'     in phaser) {$('.slider-phaser-depth').slider('value', phaser.depth);}\n                if ('rate'      in phaser) {$('.slider-phaser-rate').slider('value', phaser.rate);}\n                if ('mix'       in phaser) {$('.slider-phaser-mix').slider('value', phaser.mix);}\n                if ('feedback'  in phaser) {$('.slider-phaser-feedback').slider('value', phaser.feedback);}\n            }\n\n            if ('flanger' in patches) {\n                var flanger = patches.flanger;\n\n                if ('state'    in flanger) {setState('flanger', flanger.state);}\n                if ('time'     in flanger) {$('.slider-flanger-time').slider('value', flanger.time);}\n                if ('depth'    in flanger) {$('.slider-flanger-depth').slider('value', flanger.depth);}\n                if ('rate'     in flanger) {$('.slider-flanger-rate').slider('value', flanger.rate);}\n                if ('mix'      in flanger) {$('.slider-flanger-mix').slider('value', flanger.mix);}\n                if ('tone'     in flanger) {$('.slider-flanger-tone').slider('value', flanger.tone);}\n                if ('feedback' in flanger) {$('.slider-flanger-feedback').slider('value', flanger.feedback);}\n            }\n\n            if ('chorus' in patches) {\n                var chorus = patches.chorus;\n\n                if ('state'    in chorus) {setState('chorus', chorus.state);}\n                if ('time'     in chorus) {$('.slider-chorus-time').slider('value', chorus.time);}\n                if ('depth'    in chorus) {$('.slider-chorus-depth').slider('value', chorus.depth);}\n                if ('rate'     in chorus) {$('.slider-chorus-rate').slider('value', chorus.rate);}\n                if ('mix'      in chorus) {$('.slider-chorus-mix').slider('value', chorus.mix);}\n                if ('tone'     in chorus) {$('.slider-chorus-tone').slider('value', chorus.tone);}\n                if ('feedback' in chorus) {$('.slider-chorus-feedback').slider('value', chorus.feedback);}\n            }\n\n            if ('delay' in patches) {\n                var delay = patches.delay;\n\n                if ('state'    in delay) {setState('delay', delay.state);}\n                if ('time'     in delay) {$('.slider-delay-time').slider('value', delay.time);}\n                if ('dry'      in delay) {$('.slider-delay-dry').slider('value', delay.dry);}\n                if ('wet'      in delay) {$('.slider-delay-wet').slider('value', delay.wet);}\n                if ('tone'     in delay) {$('.slider-delay-tone').slider('value', delay.tone);}\n                if ('feedback' in delay) {$('.slider-delay-feedback').slider('value', delay.feedback);}\n            }\n\n            if ('reverb' in patches) {\n                var reverb = patches.reverb;\n\n                if ('state' in reverb) {setState('reverb', reverb.state);}\n                if ('dry'   in reverb) {$('.slider-reverb-dry').slider('value', reverb.dry);}\n                if ('wet'   in reverb) {$('.slider-reverb-wet').slider('value', reverb.wet);}\n                if ('tone'  in reverb) {$('.slider-reverb-tone').slider('value', reverb.tone);}\n            }\n\n            $timeout(function() {\n                $scope.currentPatches = getCurrentPatches();\n\n                if (isPushState) {\n                    history.pushState(getCurrentPatches(), null);\n                }\n            });\n        };\n\n        var _updatePatch = function(patchname) {\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/patch/update'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    'name'  : patchname,\n                    'patch' : angular.toJson(getCurrentPatches()),\n                    '_csrf' : $scope.csrf\n                },\n                headers         : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf       = data.csrf;\n                    $scope.isAuth     = data.isAuth;\n                    $scope.patchLists = angular.fromJson(data.patches);\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Confirmation', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                }\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf   = data.csrf;\n                    $scope.isAuth = data.isAuth;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n            });\n        };\n\n        var _deletePatch = function(patchname) {\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/patch/delete'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    'name'  : patchname,\n                    '_csrf' : $scope.csrf\n                },\n                headers         : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf       = data.csrf;\n                    $scope.isAuth     = data.isAuth;\n                    $scope.patchLists = angular.fromJson(data.patches);\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Confirmation', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                }\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf   = data.csrf;\n                    $scope.isAuth = data.isAuth;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n            });\n        };\n\n        var _ajaxErrorHandler = function() {\n            openDialog('Error', 500, 'auto', false, '<p><b>Connection to Server failed.</b></p>');\n        };\n\n        $window.onpopstate = function(event) {\n            if (event.state) {\n                _loadPatch(event.state, false);\n            } else {\n                _loadPatch(_defaultPatches, false);\n            }\n        };\n\n        $scope.isAuth      = false;\n\n        $scope.isSignin    = true;\n        $scope.isSignup    = false;\n        $scope.isPatchList = false;\n        $scope.isSavePath  = false;\n        $scope.isAccount   = false;\n\n        $scope.isDisabled  = false;\n\n        $scope.csrf = '';\n\n        $scope.signups = {\n            username : '',\n            password : ''\n        };\n\n        $scope.signins = {\n            username : '',\n            password : ''\n        };\n\n        $scope.deleteAccounts = {\n            username : '',\n            password : ''\n        };\n\n        $scope.authedUsername = '';\n\n        $scope.patchname  = '';\n        $scope.patchLists = [];\n\n        $scope.dialogPatchDetailId     = 'dialog-patch-detail';\n        $scope.isShowDialogPatchDetail = false;\n\n        $scope.$watch(function() {\n            return $scope.isAuth;\n        }, function(newVal) {\n            if (newVal) {\n                // Authenticated\n                $scope.signups = {\n                    username : '',\n                    password : ''\n                };\n\n                $scope.signins = {\n                    username : '',\n                    password : ''\n                };\n\n                $scope.currentPatches = getCurrentPatches();\n\n                $scope.toggleAction(null, 'patchList');\n            } else {\n                // Not Authenticated\n                $scope.deleteAccounts = {\n                    username : '',\n                    password : ''\n                };\n\n                $scope.currentPatches = {};\n                $scope.patches        = {};\n\n                $scope.patchname      = '';\n                $scope.patchLists     = [];\n\n                $scope.authedUsername = '';\n\n                $scope.isShowDialogPatchDetail = false;\n\n                $scope.toggleAction(null, 'signin');\n            }\n        });\n\n        // from XSoundController\n        $scope.$on('onOpenPatchDialog', function(event) {\n            $scope.currentPatches = getCurrentPatches();\n        });\n\n        /**\n         * This event handler prevents from closing modal window at typing.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.cancelClose = function(event) {\n            event.stopImmediatePropagation();\n        };\n\n        /**\n         * This event handler changes flag for Tab-Panel menu.\n         * @param {Event} event This argument is event object from ng-click directive.\n         * @param {string} action This argument is one of 'signin', 'signup', 'patchList', 'savePatch', 'account'\n         */\n        $scope.toggleAction = function(event, action) {\n            if (event !== null) {\n                event.preventDefault();\n            }\n\n            $scope.isSignin    = false;\n            $scope.isSignup    = false;\n            $scope.isPatchList = false;\n            $scope.isSavePatch = false;\n            $scope.isAccount   = false;\n\n            switch (action) {\n                case 'signin' :\n                    $scope.isSignin = true;\n                    break;\n                case 'signup' :\n                    $scope.isSignup = true;\n                    break;\n                case 'patchList' :\n                    $scope.isPatchList = true;\n                    break;\n                case 'savePatch' :\n                    $scope.isSavePatch = true;\n                    break;\n                case 'account' :\n                    $scope.isAccount = true;\n                    break;\n                default :\n                    break;\n            }\n        };\n\n        /**\n         * This event handler is to sign in.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.signin = function(event) {\n            event.preventDefault();\n\n            $scope.isDisabled = true;\n\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/account/signin'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    'username' : $scope.signins.username,\n                    'password' : $scope.signins.password,\n                    '_csrf'    : $scope.csrf\n                },\n                headers : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf           = data.csrf;\n                    $scope.isAuth         = data.isAuth;\n                    $scope.authedUsername = data.username;\n                    $scope.patchLists     = angular.fromJson(data.patches);\n                }\n\n                $scope.isDisabled = false;\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf = data.csrf;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n\n                $scope.isDisabled = false;\n            });\n        };\n\n        /**\n         * This event handler is to sign up.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.signup = function(event) {\n            event.preventDefault();\n\n            $scope.isDisabled = true;\n\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/account/signup'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    'username' : $scope.signups.username,\n                    'password' : $scope.signups.password,\n                    '_csrf'    : $scope.csrf\n                },\n                headers          : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf           = data.csrf;\n                    $scope.isAuth         = data.isAuth;\n                    $scope.authedUsername = data.username;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Confirmation', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                }\n\n                $scope.isDisabled = false;\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf = data.csrf;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n\n                $scope.isDisabled = false;\n            });\n        };\n\n        /**\n         * This event handler is to sign out.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.signout = function(event) {\n            $scope.isDisabled = true;\n\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/account/signout'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    '_csrf' : $scope.csrf\n                },\n                headers         : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf = data.csrf;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Confirmation', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                }\n\n                $scope.isDisabled = false;\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf = data.csrf;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n\n                $scope.isDisabled = false;\n            });\n        };\n\n        /**\n         * This event handler is to delete account.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.deleteAccount = function(event) {\n            // Delete OK ?\n            $('<div />').html('<p><b>Delete your account. OK ?<br /> <b class=\"dangerous\">If you delete account, the all of patches that you saved are also deleted.</b></b></p>').dialog({\n                title     : 'Confirmation',\n                autoOpen  : true,\n                show      : 'bounce',\n                hide      : 'explode',\n                modal     : false,\n                width     : 650,\n                height    : 'auto',\n                draggable : true,\n                resizable : false,\n                zIndex    : 9999,\n                buttons   : {\n                    'OK'    : function() {\n                        _deleteAccount();\n\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    },\n                    'CANCEL' : function() {\n                        $(this).dialog('close')\n                               .dialog('destroy')\n                               .remove();\n                    }\n                }\n            });\n        };\n\n        /**\n         * This event handler sets patch name.\n         * @param {Event} event This argument is event object from ng-keyup directive.\n         */\n        $scope.typePatchname = function(event) {\n            $scope.patchname = event.currentTarget.value;\n        };\n\n        /**\n         * This event handler saves the designated patch.\n         * @param {Event} event This argument is event object from ng-click directive.\n         */\n        $scope.savePatch = function(event) {\n            $scope.isDisabled = true;\n\n            $http({\n                method           : 'POST',\n                url              : (POST_ORIGIN + '/patch/add'),\n                timeout          : TIMEOUT,\n                withCredentials  : true,\n                params           : '',  // Query Parameters (GET)\n                data             : {\n                    'name'  : $scope.patchname,\n                    'patch' : angular.toJson(getCurrentPatches()),\n                    '_csrf' : $scope.csrf\n                },\n                headers          : {\n                    //'X-Requested-With' : 'XMLHttpRequest',  // Unnecessary for CORS\n                    'Content-Type' : 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                transformRequest : function(data) {\n                    // JSON -> serialize (key1=value1&key2=value2 ...)\n                    return $.param(data);\n                }\n            }).then(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf       = data.csrf;\n                    $scope.isAuth     = data.isAuth;\n                    $scope.patchLists = angular.fromJson(data.patches);\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Confirmation', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                }\n\n                $scope.isDisabled = false;\n            }).catch(function(response) {\n                var data = response.data;\n\n                if (angular.isObject(data)) {\n                    $scope.csrf   = data.csrf;\n                    $scope.isAuth = data.isAuth;\n\n                    angular.forEach(data.message, function(message) {\n                        openDialog('Error', 500, 'auto', false, ('<p><b>' + message + '</b></p>'));\n                    });\n                } else {\n                    _ajaxErrorHandler();\n                }\n\n                $scope.isDisabled = false;\n            });\n        };\n\n        /**\n         *  This event handler opens the dialog for patch details.\n         * @param {Event} event This argument is event object from ng-click directive.\n         * @param {object|string} patchList This argument is patch data as associative array or JSON.\n         */\n        $scope.openPatchDetail = function(event, patchList) {\n            if (angular.isObject(patchList) && (angular.isObject(patchList.patch))) {\n                // Node.js + MongoDB\n                $scope.patches = patchList.patch;\n            } else if (angular.isString(patchList.patch)) {\n                // PHP + MySQL\n                var patch = patchList.patch.replace(/&quot;/g, '\"')\n                                           .replace(/&apos;/g, '\\'')\n                                           .replace(/&amp;/g, '&');\n\n                $scope.patches = angular.fromJson(patch);\n            } else {\n                return;\n            }\n\n            $scope.isShowDialogPatchDetail = true;\n\n            // Define dialog\n            $('#' + $scope.dialogPatchDetailId).dialog({\n                title     : patchList.name,\n                autoOpen  : true,\n                show      : 'explode',\n                hide      : 'explode',\n                modal     : false,\n                width     : 600,\n                height    : 400,\n                draggable : true,\n                resizable : false,\n                zIndex    : 9999,\n                position  : {\n                    my : 'center top',\n                    at : 'center top'\n                },\n                buttons   : {\n                    'LOAD'   : function() {\n                        _loadPatch($scope.patches, true);\n\n                        $(this).dialog('close');\n                    },\n                    'UPDATE' : function() {\n                        // Update OK ?\n                        $('<div />').html('<p><b>Update the patch. OK ?</b></p>').dialog({\n                            title     : 'Confirmation',\n                            autoOpen  : true,\n                            show      : 'explode',\n                            hide      : 'explode',\n                            modal     : false,\n                            width     : 400,\n                            height    : 'auto',\n                            draggable : true,\n                            resizable : false,\n                            zIndex    : 10000,\n                            buttons   : {\n                                'OK'    : function() {\n                                    _updatePatch(patchList.name);\n\n                                    $(this).dialog('close')\n                                           .dialog('destroy')\n                                           .remove();\n\n                                    $('#' + $scope.dialogPatchDetailId).dialog('close');\n                                },\n                                'CANCEL' : function() {\n                                    $(this).dialog('close')\n                                           .dialog('destroy')\n                                           .remove();\n                                }\n                            }\n                        });\n                    },\n                    'DELETE' : function() {\n                        // Delet OK ?\n                        $('<div />').html('<p><b>Delete the patch. OK ?</b></p>').dialog({\n                            title     : 'Confirmation',\n                            autoOpen  : true,\n                            show      : 'explode',\n                            hide      : 'explode',\n                            modal     : false,\n                            width     : 400,\n                            height    : 'auto',\n                            draggable : true,\n                            resizable : false,\n                            zIndex    : 10000,\n                            buttons   : {\n                                'OK'    : function() {\n                                    _deletePatch(patchList.name);\n\n                                    $(this).dialog('close')\n                                           .dialog('destroy')\n                                           .remove();\n\n                                    $('#' + $scope.dialogPatchDetailId).dialog('close');\n                                },\n                                'CANCEL' : function() {\n                                    $(this).dialog('close')\n                                           .dialog('destroy')\n                                           .remove();\n                                }\n                            }\n                        });\n                    },\n                    'CLOSE'    : function() {\n                        $(this).dialog('close');\n                    }\n                },\n                close     : function(event, ui) {\n                    $(this).dialog('destroy');\n\n                    $timeout(function() {\n                        $scope.isShowDialogPatchDetail = false;\n                    });\n                }\n            });\n        };\n\n        $http({\n            method          : 'GET',\n            url             : POST_ORIGIN,\n            timeout         : TIMEOUT,\n            withCredentials : true,\n            params          : '',  // Query Parameters (GET)\n            headers         : {\n                //'X-Requested-With' : 'XMLHttpRequest'  // Unnecessary for CORS\n            }\n        }).then(function(response) {\n            var data = response.data;\n\n           if (angular.isObject(data)) {\n                $scope.isAuth         = data.isAuth;\n                $scope.authedUsername = data.username;\n                $scope.csrf           = data.csrf;\n\n                if ($scope.isAuth) {\n                    $scope.patchLists = angular.fromJson(data.patches);\n                }\n           }\n        }).catch(function(response) {\n            _ajaxErrorHandler();\n        });\n    }]);\n\n})();\n"]}